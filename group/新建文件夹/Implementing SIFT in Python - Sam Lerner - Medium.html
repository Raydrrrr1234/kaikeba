<!DOCTYPE html>
<!-- saved from url=(0069)https://medium.com/@lerner98/implementing-sift-in-python-36c619df7945 -->
<html lang="en" data-rh="lang" style=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script async="" src="./Implementing SIFT in Python - Sam Lerner - Medium_files/branch-latest.min.js.download"></script><script async="" src="./Implementing SIFT in Python - Sam Lerner - Medium_files/analytics.js.download"></script><script>!function(c,f){var t,o,i,e=[],r={passive:!0,capture:!0},n=new Date,a="pointerup",u="pointercancel";function p(n,e){t||(t=e,o=n,i=new Date,w(f),s())}function s(){0<=o&&o<i-n&&(e.forEach(function(n){n(o,t)}),e=[])}function l(n){if(n.cancelable){var e=(1e12<n.timeStamp?new Date:performance.now())-n.timeStamp;"pointerdown"==n.type?function(n,e){function t(){p(n,e),i()}function o(){i()}function i(){f(a,t,r),f(u,o,r)}c(a,t,r),c(u,o,r)}(e,n):p(e,n)}}function w(e){["click","mousedown","keydown","touchstart","pointerdown"].forEach(function(n){e(n,l,r)})}w(c),self.perfMetrics=self.perfMetrics||{},self.perfMetrics.onFirstInputDelay=function(n){e.push(n),s()}}(addEventListener,removeEventListener)</script><title>Implementing SIFT in Python - Sam Lerner - Medium</title><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"><meta data-rh="true" name="theme-color" content="#000000"><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"><meta data-rh="true" property="al:ios:app_name" content="Medium"><meta data-rh="true" property="al:ios:app_store_id" content="828256236"><meta data-rh="true" property="al:android:package" content="com.medium.reader"><meta data-rh="true" property="fb:app_id" content="542599432471018"><meta data-rh="true" property="og:site_name" content="Medium"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2018-12-27T20:02:43.639Z"><meta data-rh="true" name="title" content="Implementing SIFT in Python - Sam Lerner - Medium"><meta data-rh="true" property="og:title" content="Implementing SIFT in Python"><meta data-rh="true" property="twitter:title" content="Implementing SIFT in Python"><meta data-rh="true" name="twitter:site" content="@Medium"><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/36c619df7945"><meta data-rh="true" property="al:android:url" content="medium://p/36c619df7945"><meta data-rh="true" property="al:ios:url" content="medium://p/36c619df7945"><meta data-rh="true" property="al:android:app_name" content="Medium"><meta data-rh="true" name="description" content="There’s a lot of content about SIFT online. There are a lot of good tutorials, but each seemed to be lacking something, whether that be details about the algorithm or the implementation. So when I…"><meta data-rh="true" property="og:description" content="There’s a lot of content about SIFT online. There are a lot of good tutorials, but each seemed to be lacking something, whether that be…"><meta data-rh="true" property="twitter:description" content="There’s a lot of content about SIFT online. There are a lot of good tutorials, but each seemed to be lacking something, whether that be…"><meta data-rh="true" property="og:url" content="https://medium.com/@lerner98/implementing-sift-in-python-36c619df7945"><meta data-rh="true" property="al:web:url" content="https://medium.com/@lerner98/implementing-sift-in-python-36c619df7945"><meta data-rh="true" property="og:image" content="https://miro.medium.com/max/1200/1*vzUvEVlZWbfCDBO44fIdcw.png"><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/max/1200/1*vzUvEVlZWbfCDBO44fIdcw.png"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="article:author" content="https://medium.com/@lerner98"><meta data-rh="true" name="author" content="Sam Lerner"><meta data-rh="true" name="robots" content="index,follow"><meta data-rh="true" name="referrer" content="unsafe-url"><meta data-rh="true" name="twitter:label1" value="Reading time"><meta data-rh="true" name="twitter:data1" value="16 min read"><meta data-rh="true" name="parsely-post-id" content="36c619df7945"><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="https://medium.com/osd.xml"><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://cdn-images-1.medium.com/fit/c/152/152/1*8I-HPL0bfoIzGied-dzOvA.png"><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://cdn-images-1.medium.com/fit/c/120/120/1*8I-HPL0bfoIzGied-dzOvA.png"><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://cdn-images-1.medium.com/fit/c/76/76/1*8I-HPL0bfoIzGied-dzOvA.png"><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://cdn-images-1.medium.com/fit/c/60/60/1*8I-HPL0bfoIzGied-dzOvA.png"><link data-rh="true" rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg" color="#171717"><link data-rh="true" rel="icon" href="https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium.3Y6xpZ-0FSdWDnPM3hSBIA.ico"><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="./Implementing SIFT in Python - Sam Lerner - Medium_files/m2.css"><link data-rh="true" rel="author" href="https://medium.com/@lerner98"><link data-rh="true" rel="canonical" href="https://medium.com/@lerner98/implementing-sift-in-python-36c619df7945"><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/36c619df7945"><script data-rh="true">(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-24232453-2', 'auto');
ga('send', 'pageview');</script><link rel="preload" href="./Implementing SIFT in Python - Sam Lerner - Medium_files/16180790160.js.download" as="script"><style type="text/css" data-fela-rehydration="424" data-fela-type="STATIC">html{box-sizing:border-box}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}</style><style type="text/css" data-fela-rehydration="424" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}@-moz-keyframes k1{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}@keyframes k1{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}@-webkit-keyframes k2{0%{opacity:0}100%{opacity:1}}@-moz-keyframes k2{0%{opacity:0}100%{opacity:1}}@keyframes k2{0%{opacity:0}100%{opacity:1}}@-webkit-keyframes k3{0%{opacity:0}25%{transform:scale(.9)}100%{opacity:1;transform:scale(1)}}@-moz-keyframes k3{0%{opacity:0}25%{transform:scale(.9)}100%{opacity:1;transform:scale(1)}}@keyframes k3{0%{opacity:0}25%{transform:scale(.9)}100%{opacity:1;transform:scale(1)}}@-webkit-keyframes k4{0%{opacity:1}100%{opacity:0}}@-moz-keyframes k4{0%{opacity:1}100%{opacity:0}}@keyframes k4{0%{opacity:1}100%{opacity:0}}@-webkit-keyframes k5{0%{opacity:1;transform:scale(1)}25%{opacity:0}100%{opacity:0;transform:scale(.9)}}@-moz-keyframes k5{0%{opacity:1;transform:scale(1)}25%{opacity:0}100%{opacity:0;transform:scale(.9)}}@keyframes k5{0%{opacity:1;transform:scale(1)}25%{opacity:0}100%{opacity:0;transform:scale(.9)}}@-webkit-keyframes k6{0%{transform:matrix(0.97, 0, 0, 1, 0, 12);opacity:0}20%{transform:matrix(0.99, 0, 0, 1, 0, 2);opacity:0.7}40%{transform:matrix(1, 0, 0, 1, 0, -1);opacity:1}70%{transform:matrix(1, 0, 0, 1, 0, 0);opacity:1}100%{transform:matrix(1, 0, 0, 1, 0, 0);opacity:1}}@-moz-keyframes k6{0%{transform:matrix(0.97, 0, 0, 1, 0, 12);opacity:0}20%{transform:matrix(0.99, 0, 0, 1, 0, 2);opacity:0.7}40%{transform:matrix(1, 0, 0, 1, 0, -1);opacity:1}70%{transform:matrix(1, 0, 0, 1, 0, 0);opacity:1}100%{transform:matrix(1, 0, 0, 1, 0, 0);opacity:1}}@keyframes k6{0%{transform:matrix(0.97, 0, 0, 1, 0, 12);opacity:0}20%{transform:matrix(0.99, 0, 0, 1, 0, 2);opacity:0.7}40%{transform:matrix(1, 0, 0, 1, 0, -1);opacity:1}70%{transform:matrix(1, 0, 0, 1, 0, 0);opacity:1}100%{transform:matrix(1, 0, 0, 1, 0, 0);opacity:1}}</style><style type="text/css" data-fela-rehydration="424" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{height:100vh}.m{width:100vw}.n{display:flex}.o{align-items:center}.p{justify-content:center}.q{fill:rgba(0, 0, 0, 0.84)}.r{display:block}.s{position:fixed}.t{top:0}.u{left:0}.v{right:0}.w{z-index:500}.x{box-shadow:0 4px 12px 0 rgba(0, 0, 0, 0.05)}.ai{max-width:1192px}.aj{min-width:0}.ak{width:100%}.al{height:65px}.ao{flex:1 0 auto}.ap{display:none}.ar{flex:0 0 auto}.as{visibility:hidden}.at{color:inherit}.au{fill:inherit}.av{font-size:inherit}.aw{border:inherit}.ax{font-family:inherit}.ay{letter-spacing:inherit}.az{font-weight:inherit}.ba{padding:0}.bb{margin:0}.bc:hover{cursor:pointer}.bd:hover{color:rgba(0, 0, 0, 0.9)}.be:hover{fill:rgba(0, 0, 0, 0.9)}.bf:focus{outline:none}.bg:disabled{cursor:default}.bh:disabled{color:rgba(0, 0, 0, 0.54)}.bi:disabled{fill:rgba(0, 0, 0, 0.54)}.bj{font-family:medium-content-sans-serif-font, "Lucida Grande", "Lucida Sans Unicode", "Lucida Sans", Geneva, Arial, sans-serif}.bk{font-style:normal}.bl{line-height:20px}.bm{font-size:15.8px}.bn{letter-spacing:0px}.bo{color:rgba(0, 0, 0, 0.54)}.bp{fill:rgba(0, 0, 0, 0.54)}.bq{margin-left:16px}.br{color:rgba(2, 158, 116, 1)}.bs{fill:rgba(3, 168, 124, 1)}.bt:hover{color:rgba(1, 143, 105, 1)}.bu:hover{fill:rgba(2, 158, 116, 1)}.bv:disabled{color:rgba(3, 168, 124, 0.5)}.bw:disabled{fill:rgba(3, 168, 124, 0.5)}.bx{padding:8px 16px}.by{background:0}.bz{border-color:rgba(3, 168, 124, 1)}.ca:hover{border-color:rgba(2, 158, 116, 1)}.cb{border-radius:4px}.cc{border-width:1px}.cd{border-style:solid}.ce{box-sizing:border-box}.cf{display:inline-block}.cg{text-decoration:none}.ch{margin-bottom:0px}.cj{padding-left:24px}.ck{padding-right:24px}.cl{margin-left:auto}.cm{margin-right:auto}.cn{max-width:728px}.co{flex-direction:column}.cp{position:absolute}.cq{top:calc(100vh + 100px)}.cr{bottom:calc(100vh + 100px)}.cs{width:10px}.ct{pointer-events:none}.cu{word-break:break-word}.cv{word-wrap:break-word}.cw:after{display:block}.cx:after{content:""}.cy:after{clear:both}.cz{max-width:680px}.da{line-height:1.23}.db{letter-spacing:0}.dc{color:rgba(0, 0, 0, 0.84)}.dd{font-family:medium-content-title-font, Georgia, Cambria, "Times New Roman", Times, serif}.do{margin-bottom:-0.27em}.du{margin-top:32px}.dv{justify-content:space-between}.dz{border-radius:50%}.ea{height:48px}.eb{width:48px}.ec{margin-left:12px}.ed{margin-bottom:2px}.ef{font-weight:300}.eg{font-size:16px}.eh{overflow:hidden}.ei{max-height:20px}.ej{text-overflow:ellipsis}.ek{display:-webkit-box}.el{-webkit-line-clamp:1}.em{-webkit-box-orient:vertical}.en:hover{text-decoration:underline}.eo{margin-left:8px}.ep{padding:0px 8px}.eq{border-color:rgba(0, 0, 0, 0.54)}.er:hover{color:rgba(0, 0, 0, 0.97)}.es:hover{fill:rgba(0, 0, 0, 0.97)}.et:hover{border-color:rgba(0, 0, 0, 0.84)}.eu:disabled{fill:rgba(0, 0, 0, 0.76)}.ev:disabled{border-color:rgba(0, 0, 0, 0.2)}.ew:disabled{cursor:inherit}.ex:disabled:hover{color:rgba(0, 0, 0, 0.54)}.ey:disabled:hover{fill:rgba(0, 0, 0, 0.76)}.ez:disabled:hover{border-color:rgba(0, 0, 0, 0.2)}.fa{line-height:18px}.fb{font-size:15px}.fc{align-items:flex-end}.fk{padding-right:8px}.fl{margin-right:-6px}.fm{line-height:1.58}.fn{letter-spacing:-0.004em}.fo{font-family:medium-content-serif-font, Georgia, Cambria, "Times New Roman", Times, serif}.fz{margin-bottom:-0.46em}.ga{font-family:medium-content-slab-serif-font, Georgia, Cambria, "Times New Roman", Times, serif}.gb{font-size:28px}.gc{border:none}.gd{margin-top:30px}.ge{text-align:center}.gf:before{content:"..."}.gg:before{letter-spacing:0.6em}.gh:before{text-indent:0.6em}.gi:before{font-style:italic}.gj:before{line-height:1.4}.gk{line-height:1.12}.gl{letter-spacing:-0.022em}.gm{font-weight:600}.gv{margin-bottom:-0.28em}.hb{max-width:1224px}.hh{clear:both}.hi{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}.hj{cursor:zoom-in}.hk{position:relative}.hl{z-index:auto}.hm{opacity:0}.hn{transition:opacity 100ms 400ms}.ho{height:100%}.hp{will-change:transform}.hq{transform:translateZ(0)}.hr{margin:auto}.hs{background-color:rgba(0, 0, 0, 0.05)}.ht{padding-bottom:34.15032679738562%}.hu{filter:blur(20px)}.hv{transform:scale(1.1)}.hw{visibility:visible}.hx{background:rgba(255, 255, 255, 1)}.hy{line-height:1.4}.hz{margin-top:10px}.ic{max-width:1336px}.id{padding-bottom:50.1497005988024%}.ie{background-repeat:repeat-x}.if{background-image:linear-gradient(to right,rgba(0, 0, 0, 0.84) 100%,rgba(0, 0, 0, 0.84) 0);background-image:url('data:image/svg+xml;utf8,<svg preserveAspectRatio="none" viewBox="0 0 1 1" xmlns="http://www.w3.org/2000/svg"><line x1="0" y1="0" x2="1" y2="1" stroke="rgba(0, 0, 0, 0.84)" /></svg>')}.ig{background-size:1px 1px}.ih{background-position:0 1.05em;background-position:0 calc(1em + 1px)}.ii{list-style-type:decimal}.ij{margin-left:30px}.ik{padding-left:0px}.iq{max-width:1696px}.ir{padding-bottom:55.18867924528302%}.is{font-weight:700}.it{line-height:1.18}.je{margin-bottom:-0.31em}.jf{max-width:625px}.jg{padding-bottom:71.52%}.jh{font-style:italic}.ji{max-width:1206px}.jj{padding-bottom:72.96849087893864%}.jk{padding:20px}.jl{background:rgba(0, 0, 0, 0.05)}.jm{overflow-x:auto}.jn{font-family:Menlo, Monaco, "Courier New", Courier, monospace}.jo{margin-top:-0.09em}.jp{margin-bottom:-0.09em}.jq{white-space:pre-wrap}.jr{padding:2px 4px}.js{font-size:75%}.jt> strong{font-family:inherit}.jz{max-width:468px}.ka{padding-bottom:89.74358974358974%}.kb{max-width:496px}.kc{padding-bottom:21.370967741935484%}.kd{max-width:272px}.ke{padding-bottom:46.32352941176471%}.kf{max-width:340px}.kg{padding-bottom:31.76470588235294%}.kh{max-width:292px}.ki{padding-bottom:45.205479452054796%}.ko{will-change:opacity}.kp{width:188px}.kq{left:50%}.kr{transform:translateX(406px)}.ks{top:calc(65px + 54px + 14px)}.kv{top:calc(65px + 54px + 40px)}.kx{width:131px}.ky{padding-top:28px}.kz{margin-bottom:19px}.la{margin-left:-5px}.lb{margin-right:5px}.lc{outline:0}.ld{border:0}.le{user-select:none}.lf{cursor:pointer}.lg> svg{pointer-events:none}.lh:active{border-style:none}.li{-webkit-user-select:none}.lj{fill:rgba(0, 0, 0, 0.76)}.lk:focus{fill:rgba(0, 0, 0, 0.54)}.ll:hover{fill:rgba(0, 0, 0, 0.54)}.lm{margin-top:5px}.ln button{text-align:left}.lo{margin-top:40px}.lp{flex-wrap:wrap}.lq{margin-top:25px}.lr{list-style-type:none}.ls{margin-right:8px}.lt{margin-bottom:8px}.lu{border-radius:3px}.lv{padding:5px 10px}.lw{line-height:22px}.lx{margin-top:15px}.ly{margin-right:16px}.lz{border:1px solid rgba(0, 0, 0, 0.1)}.ma{height:60px}.mb{width:60px}.mo:hover{border-color:rgba(0, 0, 0, 0.54)}.mp:active{border-style:solid}.mq{z-index:2}.ms{padding-top:32px}.mt{border-top:1px solid rgba(0, 0, 0, 0.1)}.mu{margin-bottom:25px}.mv{margin-bottom:32px}.mw{min-height:80px}.nb{height:80px}.nc{width:80px}.nd{padding-left:102px}.nf{text-transform:uppercase}.ng{letter-spacing:0.05em}.nh{margin-bottom:6px}.ni{line-height:36px}.nj{padding:4px 12px}.nk{max-width:555px}.nl{max-width:450px}.nm{font-size:18px}.nn{line-height:24px}.np{padding-top:25px}.nq{color:rgba(0, 0, 0, 0.76)}.nr{opacity:1}.ns{border:1px solid rgba(3, 168, 124, 1)}.nt{margin-top:64px}.nu{background-color:rgba(0, 0, 0, 0.02)}.nv{padding:60px 0}.nw{background-color:rgba(0, 0, 0, 0.9)}.on{padding-bottom:48px}.oo{border-bottom:1px solid rgba(255, 255, 255, 0.54)}.op{margin:0 -12px}.oq{margin:0 12px}.or{flex:1 1 0}.os{padding-bottom:12px}.ot:hover{color:rgba(255, 255, 255, 0.99)}.ou:hover{fill:rgba(255, 255, 255, 0.99)}.ov:disabled{color:rgba(255, 255, 255, 0.7)}.ow:disabled{fill:rgba(255, 255, 255, 0.7)}.ox{color:rgba(255, 255, 255, 0.98)}.oy{fill:rgba(255, 255, 255, 0.98)}.oz{text-align:inherit}.pa{font-size:21.6px}.pb{letter-spacing:-0.32px}.pc{color:rgba(255, 255, 255, 0.7)}.pd{fill:rgba(255, 255, 255, 0.7)}.pe{text-decoration:underline}.pf{padding-bottom:8px}.pg{padding-top:8px}.ph{width:200px}.pj{-webkit-user-select:none}</style><style type="text/css" data-fela-rehydration="424" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.ah{margin:0 64px}.dm{font-size:40px}.dn{margin-top:0.78em}.dt{line-height:48px}.fj{margin-left:30px}.fx{font-size:21px}.fy{margin-top:2em}.gt{font-size:34px}.gu{margin-top:1.25em}.ha{margin-top:0.86em}.hg{margin-top:56px}.ip{margin-top:1.05em}.jc{font-size:26px}.jd{margin-top:1.72em}.jy{margin-top:1.91em}.kn{margin-top:1.95em}.ok{padding-left:64px}.ol{padding-right:64px}.om{max-width:1320px}</style><style type="text/css" data-fela-rehydration="424" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.fi{margin-left:30px}.ia{margin-left:auto}.ib{text-align:center}.oh{padding-left:64px}.oi{padding-right:64px}.oj{max-width:1080px}</style><style type="text/css" data-fela-rehydration="424" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.fh{margin-left:30px}.oe{padding-left:48px}.of{padding-right:48px}.og{max-width:904px}</style><style type="text/css" data-fela-rehydration="424" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.am{height:56px}.an{display:flex}.aq{display:block}.ci{margin-bottom:0px}.dx{margin-top:32px}.dy{flex-direction:column-reverse}.ff{margin-bottom:30px}.fg{margin-left:0px}.mx{margin-bottom:24px}.my{align-items:center}.mz{width:102px}.na{position:relative}.ne{padding-left:0}.no{margin-top:24px}.nx{padding:32px 0}.ob{padding-left:24px}.oc{padding-right:24px}.od{max-width:728px}.pi{width:140px}</style><style type="text/css" data-fela-rehydration="424" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.ac{margin:0 24px}.de{font-size:30px}.df{margin-top:0.72em}.dp{line-height:40px}.dw{margin-top:32px}.ee{margin-bottom:0px}.fd{margin-bottom:30px}.fe{margin-left:0px}.fp{font-size:18px}.fq{margin-top:1.56em}.gn{margin-top:0.93em}.gw{margin-top:0.67em}.hc{margin-top:40px}.il{margin-top:1.34em}.iu{font-size:24px}.iv{margin-top:1.23em}.ju{margin-top:1.41em}.kj{margin-top:1.2em}.ny{padding-left:24px}.nz{padding-right:24px}.oa{max-width:552px}</style><style type="text/css" data-fela-rehydration="424" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.ag{margin:0 64px}.dk{font-size:40px}.dl{margin-top:0.78em}.ds{line-height:48px}.fv{font-size:21px}.fw{margin-top:2em}.gr{font-size:34px}.gs{margin-top:1.25em}.gz{margin-top:0.86em}.hf{margin-top:56px}.io{margin-top:1.05em}.ja{font-size:26px}.jb{margin-top:1.72em}.jx{margin-top:1.91em}.km{margin-top:1.95em}</style><style type="text/css" data-fela-rehydration="424" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.af{margin:0 48px}.di{font-size:40px}.dj{margin-top:0.78em}.dr{line-height:48px}.ft{font-size:21px}.fu{margin-top:2em}.gp{font-size:34px}.gq{margin-top:1.25em}.gy{margin-top:0.86em}.he{margin-top:56px}.in{margin-top:1.05em}.iy{font-size:26px}.iz{margin-top:1.72em}.jw{margin-top:1.91em}.kl{margin-top:1.95em}</style><style type="text/css" data-fela-rehydration="424" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.ae{margin:0 24px}.dg{font-size:30px}.dh{margin-top:0.72em}.dq{line-height:40px}.fr{font-size:18px}.fs{margin-top:1.56em}.go{margin-top:0.93em}.gx{margin-top:0.67em}.hd{margin-top:40px}.im{margin-top:1.34em}.iw{font-size:24px}.ix{margin-top:1.23em}.jv{margin-top:1.41em}.kk{margin-top:1.2em}</style><style type="text/css" data-fela-rehydration="424" data-fela-type="RULE" media="print">.ab{display:none}</style><style type="text/css" data-fela-rehydration="424" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.y{transition:transform 300ms ease}.z{will-change:transform}.kt{transition:opacity 200ms}.mc{transition:border-color 150ms ease}.md::before{background:
      radial-gradient(circle, rgba(0, 0, 0, 0.84) 60%, transparent 70%)
    }.me::before{border-radius:50%}.mf::before{content:""}.mg::before{display:block}.mh::before{z-index:0}.mi::before{left:0}.mj::before{height:100%}.mk::before{position:absolute}.ml::before{top:0}.mm::before{width:100%}.mn:hover::before{animation:k1 2000ms infinite cubic-bezier(.1,.12,.25,1)}.mr{transition:fill 200ms ease}</style><style type="text/css" data-fela-rehydration="424" data-fela-type="RULE" media="all and (max-width: 1230px)">.ku{display:none}</style><style type="text/css" data-fela-rehydration="424" data-fela-type="RULE" media="all and (max-width: 1198px)">.kw{display:none}</style><style data-fela-type="RULE" type="text/css" media="(prefers-reduced-motion: reduce)"></style><script type="application/ld+json" data-rh="true">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1200\u002F1*vzUvEVlZWbfCDBO44fIdcw.png"],"url":"https:\u002F\u002Fmedium.com\u002F@lerner98\u002Fimplementing-sift-in-python-36c619df7945","dateCreated":"2018-12-27T00:49:16.529Z","datePublished":"2018-12-27T00:49:16.529Z","dateModified":"2018-12-27T20:02:43.639Z","headline":"Implementing SIFT in Python","name":"Implementing SIFT in Python","description":"There’s a lot of content about SIFT online. There are a lot of good tutorials, but each seemed to be lacking something, whether that be details about the algorithm or the implementation. So when I…","identifier":"36c619df7945","keywords":["Lite:true","Tag:Computer Vision","Tag:Sift","Tag:Python","Elevated:false","LockedPostSource:LOCKED_POST_SOURCE_NONE","LayerCake:4"],"author":{"@type":"Person","name":"Sam Lerner","url":"https:\u002F\u002Fmedium.com\u002F@lerner98"},"creator":["Sam Lerner"],"publisher":{"@type":"Organization","name":"Medium","url":"https:\u002F\u002Fmedium.com\u002F","logo":{"@type":"ImageObject","width":308,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F308\u002F1*OMF3fSqH8t4xBJ9-6oZDZw.png"}},"mainEntityOfPage":"https:\u002F\u002Fmedium.com\u002F@lerner98\u002Fimplementing-sift-in-python-36c619df7945"}</script><script type="text/javascript" data-rh="true">(function(b,r,a,n,c,h,_,s,d,k){if(!b[n]||!b[n]._q){for(;s<_.length;)c(h,_[s++]);d=r.createElement(a);d.async=1;d.src="https://cdn.branch.io/branch-latest.min.js";k=r.getElementsByTagName(a)[0];k.parentNode.insertBefore(d,k);b[n]=h}})(window,document,"script","branch",function(b,r){b[r]=function(){b._q.push([r,arguments])}},{_q:[],_v:1},"addListener applyCode autoAppIndex banner closeBanner closeJourney creditHistory credits data deepview deepviewCta first getCode init link logout redeem referrals removeListener sendSMS setBranchViewData setIdentity track validateCode trackCommerceEvent logEvent".split(" "), 0);
branch.init('key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm', {metadata: {}, 'no_journeys': true, 'disable_exit_animation': true, 'disable_entry_animation': true, 'tracking_disabled': null}, function(err, data) {});</script><script charset="utf-8" src="./Implementing SIFT in Python - Sam Lerner - Medium_files/vendors_tracing.a5df20bc.chunk.js.download"></script><script charset="utf-8" src="./Implementing SIFT in Python - Sam Lerner - Medium_files/tracing.45a59d0a.chunk.js.download"></script></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><script>window.PARSELY = window.PARSELY || {autotrack: false}</script><nav class="r s t u v c w x y z ab" style=""><div class="branch-journeys-top"><div class="n p"><div class="ac ae af ag ah ai aj ak"><div class="al n o am an"><div class="r ao w"><div class="n o"><a aria-label="Homepage" rel="noopener" href="https://medium.com/?source=post_page-----36c619df7945----------------------"><div class="ap g"><svg height="22" width="112" viewBox="0 0 111.5 22" class="q"><path d="M56.3 19.5c0 .4 0 .5.3.7l1.5 1.4v.1h-6.5V19c-.7 1.8-2.4 3-4.3 3-3.3 0-5.8-2.6-5.8-7.5 0-4.5 2.6-7.6 6.3-7.6 1.6-.1 3.1.8 3.8 2.4V3.2c0-.3-.1-.6-.3-.7l-1.4-1.4V1l6.5-.8v19.3zm-4.8-.8V9.5c-.5-.6-1.2-.9-1.9-.9-1.6 0-3.1 1.4-3.1 5.7 0 4 1.3 5.4 3 5.4.8.1 1.6-.3 2-1zm9.1 3.1V9.4c0-.3-.1-.6-.3-.7l-1.4-1.5v-.1h6.5v12.5c0 .4 0 .5.3.7l1.4 1.4v.1h-6.5zm-.2-19.2C60.4 1.2 61.5 0 63 0c1.4 0 2.6 1.2 2.6 2.6S64.4 5.3 63 5.3a2.6 2.6 0 0 1-2.6-2.7zm22.5 16.9c0 .4 0 .5.3.7l1.5 1.4v.1h-6.5v-3.2c-.6 2-2.4 3.4-4.5 3.4-2.9 0-4.4-2.1-4.4-6.2 0-1.9 0-4.1.1-6.5 0-.3-.1-.5-.3-.7L67.7 7v.1H74v8c0 2.6.4 4.4 2 4.4.9-.1 1.7-.6 2.1-1.3V9.5c0-.3-.1-.6-.3-.7l-1.4-1.5v-.2h6.5v12.4zm22 2.3c0-.5.1-6.5.1-7.9 0-2.6-.4-4.5-2.2-4.5-.9 0-1.8.5-2.3 1.3.2.8.3 1.7.3 2.5 0 1.8-.1 4.2-.1 6.5 0 .3.1.5.3.7l1.5 1.4v.1H96c0-.4.1-6.5.1-7.9 0-2.7-.4-4.5-2.2-4.5-.9 0-1.7.5-2.2 1.3v9c0 .4 0 .5.3.7l1.4 1.4v.1h-6.5V9.5c0-.3-.1-.6-.3-.7l-1.4-1.5v-.2h6.5v3.1a4.6 4.6 0 0 1 4.6-3.4c2.2 0 3.6 1.2 4.2 3.5.7-2.1 2.7-3.6 4.9-3.5 2.9 0 4.5 2.2 4.5 6.2 0 1.9-.1 4.2-.1 6.5-.1.3.1.6.3.7l1.4 1.4v.1h-6.6zm-81.4-2l1.9 1.9v.1h-9.8v-.1l2-1.9c.2-.2.3-.4.3-.7V7.3c0-.5 0-1.2.1-1.8L11.4 22h-.1L4.5 6.8c-.1-.4-.2-.4-.3-.6v10c-.1.7 0 1.3.3 1.9l2.7 3.6v.1H0v-.1L2.7 18c.3-.6.4-1.3.3-1.9v-11c0-.5-.1-1.1-.5-1.5L.7 1.1V1h7l5.8 12.9L18.6 1h6.8v.1l-1.9 2.2c-.2.2-.3.5-.3.7v15.2c0 .2.1.5.3.6zm7.6-5.9c0 3.8 1.9 5.3 4.2 5.3 1.9.1 3.6-1 4.4-2.7h.1c-.8 3.7-3.1 5.5-6.5 5.5-3.7 0-7.2-2.2-7.2-7.4 0-5.5 3.5-7.6 7.3-7.6 3.1 0 6.4 1.5 6.4 6.2v.8h-8.7zm0-.8h4.3v-.8c0-3.9-.8-4.9-2-4.9-1.4.1-2.3 1.6-2.3 5.7z"></path></svg></div><div class="r aq"><svg width="35" height="35" viewBox="5 5 35 35" class="q"><path d="M5 40V5h35v35H5zm8.56-12.63c0 .56-.03.69-.32 1.03L10.8 31.4v.4h6.97v-.4L15.3 28.4c-.29-.34-.34-.5-.34-1.03v-8.95l6.13 13.36h.71l5.26-13.36v10.64c0 .3 0 .35-.19.53l-1.85 1.8v.4h9.2v-.4l-1.83-1.8c-.18-.18-.2-.24-.2-.53V15.94c0-.3.02-.35.2-.53l1.82-1.8v-.4h-6.47l-4.62 11.55-5.2-11.54h-6.8v.4l2.15 2.63c.24.3.29.37.29.77v10.35z"></path></svg></div></a></div></div><div class="r ar w"><div class="n o"><div class="n g"><div class="hw" id="lo-post-page-navbar-upsell-button"><div><a href="https://medium.com/membership?source=upgrade_membership---nav_full------------------------" class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" rel="noopener"><span class="bj b bk bl bm bn r bo bp">Become a member</span></a></div></div><div class="hw" id="lo-post-page-navbar-sign-in-link"><div class="bq r"><span class="bj b bk bl bm bn r bo bp"><a href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2F%40lerner98%2Fimplementing-sift-in-python-36c619df7945&amp;source=post_page-----36c619df7945---------------------nav_reg-" class="br bs av aw ax ay az ba bb bc bt bu bf bg bv bw" rel="noopener">Sign in</a></span></div></div></div><div class="hw" id="lo-post-page-navbar-get-started-button"><div class="bq r"><button class="bx by br bs bz bt bu ca bc cb bj b bk bl bm bn cc cd ce cf cg bf">Get started</button></div></div></div></div></div></div></div></div></nav><div class="ch al r ci am"></div><article><section class="cj ck cl cm ak cn ce n co"></section><span class="r"></span><div><div class="cp u cq cr cs ct"></div><section class="cu cv cw cx cy"><div class="n p"><div class="ac ae af ag ah cz aj ak"><div><div id="9a7f" class="da db dc bk dd b de df dg dh di dj dk dl dm dn do"><h1 class="dd b de dp dg dq di dr dk ds dm dt dc">Implementing SIFT in Python</h1></div><div class="du"><div class="n dv dw dx dy"><div class="o n"><div><a rel="noopener" href="https://medium.com/@lerner98?source=post_page-----36c619df7945----------------------"><img alt="Sam Lerner" class="r dz ea eb" src="./Implementing SIFT in Python - Sam Lerner - Medium_files/1_IE48KfS1qALgA-1G_tvGpQ.png" width="48" height="48"></a></div><div class="ec ak r"><div class="n"><div style="flex:1"><span class="bj b bk bl bm bn r dc q"><div class="ed n o ee"><span class="bj ef eg bl eh ei ej ek el em dc"><a class="at au av aw ax ay az ba bb bc en bf bg bh bi" rel="noopener" href="https://medium.com/@lerner98?source=post_page-----36c619df7945----------------------">Sam Lerner</a></span><div class="eo r ar h"><button class="ep dc q by eq er es et bc bh eu ev ew ex ey ez cb bj b bk fa fb bn cc cd ce cf cg bf">Follow</button></div></div></span></div></div><span class="bj b bk bl bm bn r bo bp"><span class="bj ef eg bl eh ei ej ek el em bo"><div><a class="at au av aw ax ay az ba bb bc en bf bg bh bi" rel="noopener" href="https://medium.com/@lerner98/implementing-sift-in-python-36c619df7945?source=post_page-----36c619df7945----------------------">Dec 27, 2018</a> <!-- -->·<!-- --> <!-- -->16<!-- --> min read</div></span></span></div></div><div class="n fc fd fe ff fg fh fi fj ab"><div class="n o"><div class="fk r ar"><a href="https://medium.com/p/36c619df7945/share/twitter?source=post_actions_header---------------------------" class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" target="_blank" rel="noopener nofollow"><svg width="29" height="29" class="q"><path d="M22.05 7.54a4.47 4.47 0 0 0-3.3-1.46 4.53 4.53 0 0 0-4.53 4.53c0 .35.04.7.08 1.05A12.9 12.9 0 0 1 5 6.89a5.1 5.1 0 0 0-.65 2.26c.03 1.6.83 2.99 2.02 3.79a4.3 4.3 0 0 1-2.02-.57v.08a4.55 4.55 0 0 0 3.63 4.44c-.4.08-.8.13-1.21.16l-.81-.08a4.54 4.54 0 0 0 4.2 3.15 9.56 9.56 0 0 1-5.66 1.94l-1.05-.08c2 1.27 4.38 2.02 6.94 2.02 8.3 0 12.86-6.9 12.84-12.85.02-.24 0-.43 0-.65a8.68 8.68 0 0 0 2.26-2.34c-.82.38-1.7.62-2.6.72a4.37 4.37 0 0 0 1.95-2.51c-.84.53-1.81.9-2.83 1.13z"></path></svg></a></div><div class="fk r ar"><a href="https://medium.com/p/36c619df7945/share/facebook?source=post_actions_header---------------------------" class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" target="_blank" rel="noopener nofollow"><svg width="29" height="29" class="q"><path d="M23.2 5H5.8a.8.8 0 0 0-.8.8V23.2c0 .44.35.8.8.8h9.3v-7.13h-2.38V13.9h2.38v-2.38c0-2.45 1.55-3.66 3.74-3.66 1.05 0 1.95.08 2.2.11v2.57h-1.5c-1.2 0-1.48.57-1.48 1.4v1.96h2.97l-.6 2.97h-2.37l.05 7.12h5.1a.8.8 0 0 0 .79-.8V5.8a.8.8 0 0 0-.8-.79"></path></svg></a></div><div class="fl r ao"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40lerner98%2Fimplementing-sift-in-python-36c619df7945&amp;source=post_actions_header--------------------------bookmark_sidebar-" class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></div></div></div></div></div></div><p id="cba6" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">There’s a lot of content about SIFT online. There are a lot of good tutorials, but each seemed to be lacking something, whether that be details about the algorithm or the implementation. So when I decided I wanted to implement SIFT for myself, I found myself struggling to pull content from many, sometimes conflicting, sources. I have finally completed the task and have decided to share my process as well as some of the details other tutorials fail to mention.</p></div></div></section><hr class="ga ef gb gc gd ge gf gg gh gi gj"><section class="cu cv cw cx cy"><div class="n p"><div class="ac ae af ag ah cz aj ak"><h1 id="a1e2" class="gk gl dc bk bj gm de gn dg go gp gq gr gs gt gu gv" data-selectable-paragraph="">Introduction</h1><p id="79bf" class="fm fn dc bk fo b fp gw fr gx ft gy fv gz fx ha fz cu" data-selectable-paragraph="">For starters, what even is SIFT? SIFT, which stands for Scale Invariant Feature Transform, is a method for extracting feature vectors that describe local patches of an image. Not only are these feature vectors scale-invariant, but they are also invariant to translation, rotation, and illumination. Pretty much the holy grail for a descriptor.</p><p id="b64e" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">These descriptors are useful for matching objects are patches between images. For example, consider creating a panorama. Assuming each image has some overlapping parts, you need some way to align them so we can stitch them together. If we have some points in each image that we know correspond, we can warp one of the images using a homography. SIFT helps with automatically finding not only corresponding points in each image, but points that are easy to match.</p><figure class="hc hd he hf hg hh cl cm paragraph-image"><div class="hi hj hk hl ak"><div class="cl cm hb"><div class="hr r hk hs"><div class="ht r"><div class="hm hn cp t u ho ak eh hp hq"><img class="cp t u ho ak hu hv as rl" src="./Implementing SIFT in Python - Sam Lerner - Medium_files/1_pwOhfFcv28p90fgwWhBzzw.png" width="1224" height="418" role="presentation"></div><img class="nr pk cp t u ho ak hx" width="1224" height="418" role="presentation" src="./Implementing SIFT in Python - Sam Lerner - Medium_files/1_pwOhfFcv28p90fgwWhBzzw(1).png"><noscript><img class="cp t u ho ak" src="https://miro.medium.com/max/2448/1*pwOhfFcv28p90fgwWhBzzw.png" width="1224" height="418" role="presentation"/></noscript></div></div></div></div><figcaption class="bo eg hy hz ge cn cl cm ia ib bj ef" data-selectable-paragraph="">Two images with an overlapping region</figcaption></figure><figure class="hc hd he hf hg hh cl cm paragraph-image"><div class="hi hj hk hl ak"><div class="cl cm ic"><div class="hr r hk hs"><div class="id r"><div class="hm hn cp t u ho ak eh hp hq"><img class="cp t u ho ak hu hv as rl" src="./Implementing SIFT in Python - Sam Lerner - Medium_files/1_5LTZZiJIGUNnPXr_EGm_nQ.png" width="1336" height="670" role="presentation"></div><img class="nr pk cp t u ho ak hx" width="1336" height="670" role="presentation" src="./Implementing SIFT in Python - Sam Lerner - Medium_files/1_5LTZZiJIGUNnPXr_EGm_nQ(1).png"><noscript><img class="cp t u ho ak" src="https://miro.medium.com/max/2672/1*5LTZZiJIGUNnPXr_EGm_nQ.png" width="1336" height="670" role="presentation"/></noscript></div></div></div></div><figcaption class="bo eg hy hz ge cn cl cm ia ib bj ef" data-selectable-paragraph="">Result after transforming one image using the homography from SIFT feature points</figcaption></figure></div></div></section><hr class="ga ef gb gc gd ge gf gg gh gi gj"><section class="cu cv cw cx cy"><div class="n p"><div class="ac ae af ag ah cz aj ak"><h1 id="6915" class="gk gl dc bk bj gm de gn dg go gp gq gr gs gt gu gv" data-selectable-paragraph="">Description of the Algorithm</h1><p id="b20c" class="fm fn dc bk fo b fp gw fr gx ft gy fv gz fx ha fz cu" data-selectable-paragraph="">As described on Wikipedia: <a href="http://wikipedia/" class="at cg ie if ig ih" target="_blank" rel="noopener nofollow">https://en.wikipedia.org/wiki/Scale-invariant_feature_transform</a>, the SIFT algorithm has four main steps:</p><ol class=""><li id="c446" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz ii ij ik" data-selectable-paragraph="">Scale-Space Extrema Detection</li><li id="f8de" class="fm fn dc bk fo b fp il fr im ft in fv io fx ip fz ii ij ik" data-selectable-paragraph="">Keypoint Localization</li><li id="52a0" class="fm fn dc bk fo b fp il fr im ft in fv io fx ip fz ii ij ik" data-selectable-paragraph="">Orientation Assignment</li><li id="4da9" class="fm fn dc bk fo b fp il fr im ft in fv io fx ip fz ii ij ik" data-selectable-paragraph="">Local Descriptor Creation</li></ol></div></div></section><hr class="ga ef gb gc gd ge gf gg gh gi gj"><section class="cu cv cw cx cy"><div class="n p"><div class="ac ae af ag ah cz aj ak"><h1 id="95e3" class="gk gl dc bk bj gm de gn dg go gp gq gr gs gt gu gv" data-selectable-paragraph="">Scale-Space Extrema Detection</h1><p id="b1e9" class="fm fn dc bk fo b fp gw fr gx ft gy fv gz fx ha fz cu" data-selectable-paragraph="">The characteristic scale of a feature can be detected using a scale-normalized Laplacian-of-Gaussian (LoG) filter. This is what the LoG filter looks like:</p><figure class="hc hd he hf hg hh cl cm paragraph-image"><div class="hi hj hk hl ak"><div class="cl cm iq"><div class="hr r hk hs"><div class="ir r"><div class="hm hn cp t u ho ak eh hp hq"><img class="cp t u ho ak hu hv as rl" src="./Implementing SIFT in Python - Sam Lerner - Medium_files/1_nBfErR8RyTc05d82owhDWw.png" width="1696" height="936" role="presentation"></div><img class="nr pk cp t u ho ak hx" width="1696" height="936" role="presentation" src="./Implementing SIFT in Python - Sam Lerner - Medium_files/1_nBfErR8RyTc05d82owhDWw(1).png"><noscript><img class="cp t u ho ak" src="https://miro.medium.com/max/3392/1*nBfErR8RyTc05d82owhDWw.png" width="1696" height="936" role="presentation"/></noscript></div></div></div></div><figcaption class="bo eg hy hz ge cn cl cm ia ib bj ef" data-selectable-paragraph="">Negative LoG</figcaption></figure><p id="6926" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">The LoG filter is highly peaked at the center while becoming slightly negative and then zero at a distance from the center characterized by the standard deviation, sigma, of the Gaussian.</p><p id="b6f7" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">Therefore, the LoG filter is most highly activated by a circle, or blob, with radius proportional to sigma. However, the Gaussian is normalized, i.e. if you integrate it over all space it sums to one. Therefore, with a higher sigma and therefore a wider Gaussian, the response of the LoG filter for that Gaussian will be lower than for a smaller sigma. Therefore, SIFT uses the <strong class="fo is">scale-normalized</strong> LoG filter which is the regular LoG multiplied by the variance (sigma squared).</p><h2 id="f8b5" class="it gl dc bk bj gm iu iv iw ix iy iz ja jb jc jd je" data-selectable-paragraph="">DoG Approximation</h2><p id="1375" class="fm fn dc bk fo b fp gw fr gx ft gy fv gz fx ha fz cu" data-selectable-paragraph="">While the scale-normalized LoG is fine and dandy, it is expensive to compute, especially since we need to calculate it at many different scales. Thankfully, the authors of SIFT came up with a clever way to efficiently calculate the LoG at many scales.</p><p id="b722" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">It turns out that the difference of two Gaussians with similar variance yields a filter that approximates the scale-normalized LoG very well:</p><figure class="hc hd he hf hg hh cl cm paragraph-image"><div class="hi hj hk hl ak"><div class="cl cm jf"><div class="hr r hk hs"><div class="jg r"><div class="hm hn cp t u ho ak eh hp hq"><img class="cp t u ho ak hu hv as rl" src="./Implementing SIFT in Python - Sam Lerner - Medium_files/1_jFQVYG7VrXs44V0Qbr1GUQ.gif" width="625" height="447" role="presentation"></div><img class="nr pk cp t u ho ak hx" width="625" height="447" role="presentation" src="./Implementing SIFT in Python - Sam Lerner - Medium_files/1_jFQVYG7VrXs44V0Qbr1GUQ(1).gif"><noscript><img class="cp t u ho ak" src="https://miro.medium.com/max/1250/1*jFQVYG7VrXs44V0Qbr1GUQ.gif" width="625" height="447" role="presentation"/></noscript></div></div></div></div><figcaption class="bo eg hy hz ge cn cl cm ia ib bj ef" data-selectable-paragraph="">The difference of two Gaussians approximates the Laplacian of a Gaussian</figcaption></figure><h2 id="9a92" class="it gl dc bk bj gm iu iv iw ix iy iz ja jb jc jd je" data-selectable-paragraph="">DoG Pyramid</h2><p id="430f" class="fm fn dc bk fo b fp gw fr gx ft gy fv gz fx ha fz cu" data-selectable-paragraph="">Now that we have an efficient way to approximate the LoG, we need to compute it at multiple scales. SIFT uses a number of <em class="jh">octaves</em> to calculate the DoG. Most people would think that an octave means that eight images are computed. However, an octave is actually a set of images were the blur of the last image is <strong class="fo is">double</strong> the blur of the first image.</p><p id="eea4" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">To create this octave, we first need to choose the number of images we want in each octave. This is denoted by s. Then the sigma for the Gaussian filter is chosen to be 2^(1/s). Since blur accumulates multiplicatively, when we blur the original image with this filter s times, the result will have blur = 2 * original blur.</p><p id="ddb3" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">One detail from the paper that I rarely see mentioned is that in each octave, you actually need to produce s+3 images (including the original image). This is because when adjacent levels are subtracted to obtain the approximated LoG octave, we will get one less image than in the Gaussian octave:</p><figure class="hc hd he hf hg hh cl cm paragraph-image"><div class="hi hj hk hl ak"><div class="cl cm ji"><div class="hr r hk hs"><div class="jj r"><div class="hm hn cp t u ho ak eh hp hq"><img class="cp t u ho ak hu hv as rl" src="./Implementing SIFT in Python - Sam Lerner - Medium_files/1_vzUvEVlZWbfCDBO44fIdcw.png" width="1206" height="880" role="presentation"></div><img class="nr pk cp t u ho ak hx" width="1206" height="880" role="presentation" src="./Implementing SIFT in Python - Sam Lerner - Medium_files/1_vzUvEVlZWbfCDBO44fIdcw(1).png"><noscript><img class="cp t u ho ak" src="https://miro.medium.com/max/2412/1*vzUvEVlZWbfCDBO44fIdcw.png" width="1206" height="880" role="presentation"/></noscript></div></div></div></div><figcaption class="bo eg hy hz ge cn cl cm ia ib bj ef" data-selectable-paragraph="">DoG pyramid used for SIFT</figcaption></figure><p id="19df" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">Now we have s+2 images in the DoG octave. However, later when we look for extrema in the DoG, we will look for the min or max of a neighborhood specified by the current and adjacent levels. Obviously, this neighborhood cannot be obtained at the top or bottom level, so we have these two extra levels so that the neighborhood is defined over a full octave in the scale space. This will be more clear in the next section.</p><p id="fc46" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">After we have generated the Gaussian octave, we downsample the top level by two and use that as the bottom level for a new octave. The original paper uses four octaves. These octaves make up what I call the Gaussian pyramid.</p><h2 id="d205" class="it gl dc bk bj gm iu iv iw ix iy iz ja jb jc jd je" data-selectable-paragraph="">Implementation</h2><p id="1a39" class="fm fn dc bk fo b fp gw fr gx ft gy fv gz fx ha fz cu" data-selectable-paragraph="">Finally we are getting to some code. First, we obviously need a Gaussian filter for creation of the Gaussian octave:</p><pre class="hc hd he hf hg jk jl jm"><span id="dbb7" class="it gl dc bk jn b eg jo jp r jq" data-selectable-paragraph="">def gaussian_filter(sigma): <br>  size = 2*np.ceil(3*sigma)+1 <br>  x, y = np.mgrid[-size//2 + 1:size//2 + 1, -size//2 + 1:size//2 + 1] <br>  g = np.exp(-((x**2 + y**2)/(2.0*sigma**2))) / (2*np.pi*sigma**2)<br>  return g/g.sum()</span></pre><p id="7c75" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">This assumes that numpy is already imported as np (as it always should be). I also put it in a file called <code class="hs jr js jt jn b">gaussian_filter.py</code>. Next, to generate a Gaussian octave, we simply need to select sigma (or k as it is called in the paper) and repeatedly convolve with this Gaussian filter:</p><pre class="hc hd he hf hg jk jl jm"><span id="6ff6" class="it gl dc bk jn b eg jo jp r jq" data-selectable-paragraph="">from scipy.ndimage.filters import convolve <br>from gaussian_filter import gaussian_filter </span><span id="3ca6" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">def generate_octave(init_level, s, sigma): <br>  octave = [init_level] <br>  k = 2**(1/s) <br>  kernel = gaussian_filter(k * sigma) </span><span id="d5a9" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">  for _in range(s+2): <br>    next_level = convolve(octave[-1], kernel) <br>    octave.append(next_level) </span><span id="c84c" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">  return octave</span></pre><p id="41ea" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">Just as in the paper, I use an s of 5. One other thing to note is sigma parameter. This parameter is used to scale k so that the blur in each DoG octave goes from sigma -&gt; 2*sigma. I use a value of 1.6 for sigma. Then to generate the whole Gaussian pyramid:</p><pre class="hc hd he hf hg jk jl jm"><span id="50de" class="it gl dc bk jn b eg jo jp r jq" data-selectable-paragraph="">def generate_gaussian_pyramid(im, num_octave, s, sigma): <br>  pyr = [] </span><span id="9e07" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">  for _ in range(num_octave): <br>    octave = generate_octave(im, s, sigma) <br>    pyr.append(octave) <br>    im = octave[-3][::2, ::2] </span><span id="86d3" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">  return pyr</span></pre><p id="5b28" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">Since we generate s+3 images per octave, we use the third to last image as the base for the next octave since that is the one with a blur of 2*sigma.</p><p id="1653" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">Now that we have the Gaussian pyramid, it is trivial to create the DoG pyramid:</p><pre class="hc hd he hf hg jk jl jm"><span id="cddb" class="it gl dc bk jn b eg jo jp r jq" data-selectable-paragraph="">def generate_DoG_octave(gaussian_octave): <br>  octave = [] </span><span id="bab9" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">  for i in range(1, len(gaussian_octave)):   <br>    octave.append(gaussian_octave[i] — gaussian_octave[i-1]) </span><span id="edfc" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">  return np.concatenate([o[:,:,np.newaxis] for o in octave], axis=2) </span><span id="39c9" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">def generate_DoG_pyramid(gaussian_pyramid): <br>  pyr = [] </span><span id="c133" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">  for gaussian_octave in gaussian_pyramid: <br>    pyr.append(generate_DoG_octave(gaussian_octave)) </span><span id="2551" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">  return pyr</span></pre><p id="8004" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">Now we have four DoG octaves, each with s+2 levels of blur. We can now move on to detecting extrema in the scale space.</p><h2 id="c736" class="it gl dc bk bj gm iu iv iw ix iy iz ja jb jc jd je" data-selectable-paragraph="">Extrema Detection</h2><p id="8cae" class="fm fn dc bk fo b fp gw fr gx ft gy fv gz fx ha fz cu" data-selectable-paragraph="">The first step in extrema detection is to scan over each scale-space DoG octave, D, and include the center of each 3x3x3 neighborhood as a keypoint if it is the minimum or maximum value in neighborhood.</p><figure class="hc hd he hf hg hh cl cm paragraph-image"><div class="cl cm jz"><div class="hr r hk hs"><div class="ka r"><div class="hm hn cp t u ho ak eh hp hq"><img class="cp t u ho ak hu hv as rl" src="./Implementing SIFT in Python - Sam Lerner - Medium_files/1_kwBQSL5U-QGSLd-ovlAHFw.png" width="468" height="420" role="presentation"></div><img class="nr pk cp t u ho ak hx" width="468" height="420" role="presentation" src="./Implementing SIFT in Python - Sam Lerner - Medium_files/1_kwBQSL5U-QGSLd-ovlAHFw(1).png"><noscript><img class="cp t u ho ak" src="https://miro.medium.com/max/936/1*kwBQSL5U-QGSLd-ovlAHFw.png" width="468" height="420" role="presentation"/></noscript></div></div></div><figcaption class="bo eg hy hz ge cn cl cm ia ib bj ef" data-selectable-paragraph="">Neighborhood for the initial scale-space extrema detection</figcaption></figure><p id="5ff4" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">This is why we generated s+2 levels in the DoG octave, since we cannot scan over the points in the top or bottom level, but we still want to get keypoints over a full octave of blur.</p><h2 id="cec6" class="it gl dc bk bj gm iu iv iw ix iy iz ja jb jc jd je" data-selectable-paragraph="">Implementation</h2><p id="9a69" class="fm fn dc bk fo b fp gw fr gx ft gy fv gz fx ha fz cu" data-selectable-paragraph="">Given a DoG octave, we obtain the initial candidate keypoints with:</p><pre class="hc hd he hf hg jk jl jm"><span id="fac8" class="it gl dc bk jn b eg jo jp r jq" data-selectable-paragraph="">def get_candidate_keypoints(D, w=16): <br>  candidates = [] <br>  D[:,:,0] = 0 <br>  D[:,:,-1] = 0 </span><span id="b767" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">  for i in range(w//2+1, D.shape[0]-w//2–1): <br>    for j in range(w//2+1, D.shape[1]-w//2–1): <br>      for k in range(1, D.shape[2]-1): <br>        patch = D[i-1:i+2, j-1:j+2, k-1:k+2] <br>        if np.argmax(patch) == 13 or np.argmin(patch) == 13: <br>          candidates.append([i, j, k]) </span><span id="7a6c" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">  return candidates</span></pre><p id="7d56" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">I have a few things to say about this code:</p><ol class=""><li id="2f72" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz ii ij ik" data-selectable-paragraph="">I set the top and bottom extra levels to 0 because I was initially only getting extrema in those levels. This is probably due an incorrect construction of the DoG octave, but it seems to work well enough.</li><li id="cf8b" class="fm fn dc bk fo b fp il fr im ft in fv io fx ip fz ii ij ik" data-selectable-paragraph="">Instead of scanning with a padding of one on each level, we have a padding of w/2 where w is the side length for the patches used when creating local descriptors. Without this, I was getting out of bounds errors.</li><li id="9b58" class="fm fn dc bk fo b fp il fr im ft in fv io fx ip fz ii ij ik" data-selectable-paragraph="">Calling <code class="hs jr js jt jn b">argmax</code> or <code class="hs jr js jt jn b">argmin</code> without an axis parameter runs on the flattened array. Since our neighborhood is 3x3x3, or 27 elements long, when the extrema is our inspected pixel, the value of argmax or argmin will be 13.</li></ol><p id="91f3" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">These candidate keypoints yield many poor choices and/or noisy, so in the next section we will throw out bad ones as well refine good ones.</p></div></div></section><hr class="ga ef gb gc gd ge gf gg gh gi gj"><section class="cu cv cw cx cy"><div class="n p"><div class="ac ae af ag ah cz aj ak"><h1 id="7b4b" class="gk gl dc bk bj gm de gn dg go gp gq gr gs gt gu gv" data-selectable-paragraph="">Keypoint Localization</h1><p id="5cc3" class="fm fn dc bk fo b fp gw fr gx ft gy fv gz fx ha fz cu" data-selectable-paragraph="">We will perform three steps to get better keypoints:</p><ol class=""><li id="33cc" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz ii ij ik" data-selectable-paragraph="">Compute the subpixel location of each keypoint</li><li id="f662" class="fm fn dc bk fo b fp il fr im ft in fv io fx ip fz ii ij ik" data-selectable-paragraph="">Throw out that keypoint if it’s scale-space value at the subpixel is below a threshold</li><li id="1adf" class="fm fn dc bk fo b fp il fr im ft in fv io fx ip fz ii ij ik" data-selectable-paragraph="">Eliminate keypoints on edges using the Hessian around each subpixel keypoint</li></ol><h2 id="6ed7" class="it gl dc bk bj gm iu iv iw ix iy iz ja jb jc jd je" data-selectable-paragraph="">Subpixel Localization</h2><p id="b358" class="fm fn dc bk fo b fp gw fr gx ft gy fv gz fx ha fz cu" data-selectable-paragraph="">In many images, the resolution is not fine enough to find stable keypoints, i.e. in the same location in multiple images under multiple conditions. Therefore, the creators of SIFT use the second-order Taylor expansion of the DoG octave to further localize each keypoint.</p><figure class="hc hd he hf hg hh cl cm paragraph-image"><div class="cl cm kb"><div class="hr r hk hs"><div class="kc r"><div class="hm hn cp t u ho ak eh hp hq"><img class="cp t u ho ak hu hv as rl" src="./Implementing SIFT in Python - Sam Lerner - Medium_files/1_vKFAMxBpUc5EMpPJ4wBPxg.png" width="496" height="106" role="presentation"></div><img class="nr pk cp t u ho ak hx" width="496" height="106" role="presentation" src="./Implementing SIFT in Python - Sam Lerner - Medium_files/1_vKFAMxBpUc5EMpPJ4wBPxg(1).png"><noscript><img class="cp t u ho ak" src="https://miro.medium.com/max/992/1*vKFAMxBpUc5EMpPJ4wBPxg.png" width="496" height="106" role="presentation"/></noscript></div></div></div><figcaption class="bo eg hy hz ge cn cl cm ia ib bj ef" data-selectable-paragraph="">Second-order Taylor expansion of the DoG octave</figcaption></figure><p id="4fc2" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">Here, x is the three-dimensional vector [x, y, sigma] corresponding to the pixel location of the candidate keypoint. Taking the derivative of this equation with respect to x and setting it equal to zero yields the subpixel offset for the keypoint:</p><figure class="hc hd he hf hg hh cl cm paragraph-image"><div class="cl cm kd"><div class="hr r hk hs"><div class="ke r"><div class="hm hn cp t u ho ak eh hp hq"><img class="cp t u ho ak hu hv as rl" src="./Implementing SIFT in Python - Sam Lerner - Medium_files/1_y2yhBZyDyAcEesR9t0htKA.png" width="272" height="126" role="presentation"></div><img class="nr pk cp t u ho ak hx" width="272" height="126" role="presentation" src="./Implementing SIFT in Python - Sam Lerner - Medium_files/1_y2yhBZyDyAcEesR9t0htKA(1).png"><noscript><img class="cp t u ho ak" src="https://miro.medium.com/max/544/1*y2yhBZyDyAcEesR9t0htKA.png" width="272" height="126" role="presentation"/></noscript></div></div></div><figcaption class="bo eg hy hz ge cn cl cm ia ib bj ef" data-selectable-paragraph="">Candidate keypoint offset (second-order)</figcaption></figure><p id="2ddd" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">This offset is added to the original keypoint location to achieve subpixel accuracy.</p><p id="94db" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">If you uncomfortable with this math, I would suggest reading the paper or some other sources on Taylor expansions because this post is already becoming a behemoth.</p><h2 id="adac" class="it gl dc bk bj gm iu iv iw ix iy iz ja jb jc jd je" data-selectable-paragraph="">Implementation</h2><p id="8ab2" class="fm fn dc bk fo b fp gw fr gx ft gy fv gz fx ha fz cu" data-selectable-paragraph="">We need to compute both the Jacobian and Hessian around each candidate keypoint in order to get the offset:</p><pre class="hc hd he hf hg jk jl jm"><span id="746c" class="it gl dc bk jn b eg jo jp r jq" data-selectable-paragraph="">def localize_keypoint(D, x, y, s): <br>  dx = (D[y,x+1,s]-D[y,x-1,s])/2. <br>  dy = (D[y+1,x,s]-D[y-1,x,s])/2. <br>  ds = (D[y,x,s+1]-D[y,x,s-1])/2. </span><span id="5a10" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">  dxx = D[y,x+1,s]-2*D[y,x,s]+D[y,x-1,s] <br>  dxy = ((D[y+1,x+1,s]-D[y+1,x-1,s]) — (D[y-1,x+1,s]-D[y-1,x-1,s]))/4. <br>  dxs = ((D[y,x+1,s+1]-D[y,x-1,s+1]) — (D[y,x+1,s-1]-D[y,x-1,s-1]))/4. <br>  dyy = D[y+1,x,s]-2*D[y,x,s]+D[y-1,x,s] <br>  dys = ((D[y+1,x,s+1]-D[y-1,x,s+1]) — (D[y+1,x,s-1]-D[y-1,x,s-1]))/4. <br>  dss = D[y,x,s+1]-2*D[y,x,s]+D[y,x,s-1] </span><span id="41b8" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">  J = np.array([dx, dy, ds]) <br>  HD = np.array([ [dxx, dxy, dxs], [dxy, dyy, dys], [dxs, dys, dss]]) </span><span id="fdcf" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">  offset = -LA.inv(HD).dot(J)<br>  return offset, J, HD[:2,:2], x, y, s</span></pre><p id="a820" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">First, the first derivatives are computed for the Jacobian. Then, we compute the second derivatives for the Hessian. Thankfully, the Hessian is symmetric, so we only have to calculate six derivatives instead of nine. We return J and H because we will need them later.</p><p id="3d77" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">As a side note, when a dimension of the offset is greater than 0.5, that means it is actually closer to another pixel-level keypoint. The paper says to redo this process with the candidate keypoint closer to the offset but I couldn’t get it to work.</p><p id="3756" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">Again, if you’re uncomfortable with multivariable calculus or don’t really understand what I’m saying, I suggest you read up on it before continuing.</p><h2 id="a046" class="it gl dc bk bj gm iu iv iw ix iy iz ja jb jc jd je" data-selectable-paragraph="">Discarding Low-Contrast Keypoints</h2><p id="2f65" class="fm fn dc bk fo b fp gw fr gx ft gy fv gz fx ha fz cu" data-selectable-paragraph="">The contrast for each subpixel keypoint can now be computed as:</p><figure class="hc hd he hf hg hh cl cm paragraph-image"><div class="cl cm kf"><div class="hr r hk hs"><div class="kg r"><div class="hm hn cp t u ho ak eh hp hq"><img class="cp t u ho ak hu hv as rl" src="./Implementing SIFT in Python - Sam Lerner - Medium_files/1_2906rv2nl7qFTyWWqun9gA.png" width="340" height="108" role="presentation"></div><img class="nr pk cp t u ho ak hx" width="340" height="108" role="presentation" src="./Implementing SIFT in Python - Sam Lerner - Medium_files/1_2906rv2nl7qFTyWWqun9gA(1).png"><noscript><img class="cp t u ho ak" src="https://miro.medium.com/max/680/1*2906rv2nl7qFTyWWqun9gA.png" width="340" height="108" role="presentation"/></noscript></div></div></div><figcaption class="bo eg hy hz ge cn cl cm ia ib bj ef" data-selectable-paragraph="">Subpixel keypoint contrast</figcaption></figure><p id="b45d" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">Which is the subpixel offset added to the pixel-level location. If the absolute value is below a threshold, we throw the point out. We do this because we want extrema that are, well, extreme.</p><h2 id="0c48" class="it gl dc bk bj gm iu iv iw ix iy iz ja jb jc jd je" data-selectable-paragraph="">Eliminating Edge Responses</h2><p id="94bc" class="fm fn dc bk fo b fp gw fr gx ft gy fv gz fx ha fz cu" data-selectable-paragraph="">The scale-normalized LoG will create high-contrast responses on both corners as well as edges. However, keypoints on edges should be discarded because their orientation is ambiguous. To do this, we use the Hessian calculated when computing the subpixel offset. This process is very similar to finding corners using a Harris corner detector.</p><p id="e8fe" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">The Hessian that we return from <code class="hs jr js jt jn b">localize_keypoint</code> is of the form:</p><figure class="hc hd he hf hg hh cl cm paragraph-image"><div class="cl cm kh"><div class="hr r hk hs"><div class="ki r"><div class="hm hn cp t u ho ak eh hp hq"><img class="cp t u ho ak hu hv as rl" src="./Implementing SIFT in Python - Sam Lerner - Medium_files/1_bgkZDxW9KCST_Q9OjQ5OnQ.png" width="292" height="132" role="presentation"></div><img class="nr pk cp t u ho ak hx" width="292" height="132" role="presentation" src="./Implementing SIFT in Python - Sam Lerner - Medium_files/1_bgkZDxW9KCST_Q9OjQ5OnQ(1).png"><noscript><img class="cp t u ho ak" src="https://miro.medium.com/max/584/1*bgkZDxW9KCST_Q9OjQ5OnQ.png" width="292" height="132" role="presentation"/></noscript></div></div></div><figcaption class="bo eg hy hz ge cn cl cm ia ib bj ef" data-selectable-paragraph="">The Hessian in scale space. Proportional to curvature</figcaption></figure><p id="76a3" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">If you are familiar with the Harris detector, if the eigenvalues of H (say A and B) are both large, then the keypoint is most likely a corner. Conversely, if one is substantially larger, then it is most likely an edge.</p><p id="fc7f" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">Even though it is inexpensive to calculate the eigenvalues for this matrix, there is another way to do it involving taking the trace and determinant of H. We will forgo that discussing here but it is in the original paper.</p><h2 id="9a2c" class="it gl dc bk bj gm iu iv iw ix iy iz ja jb jc jd je" data-selectable-paragraph="">Implementation</h2><p id="ba4e" class="fm fn dc bk fo b fp gw fr gx ft gy fv gz fx ha fz cu" data-selectable-paragraph="">We perform the aforementioned steps in the following function:</p><pre class="hc hd he hf hg jk jl jm"><span id="f512" class="it gl dc bk jn b eg jo jp r jq" data-selectable-paragraph="">def find_keypoints_for_DoG_octave(D, R_th, t_c, w): <br>  candidates = get_candidate_keypoints(D, w)<br>  keypoints = [] </span><span id="2497" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">  for i, cand in enumerate(candidates): <br>    y, x, s = cand[0], cand[1], cand[2] <br>    offset, J, H, x, y, s = localize_keypoint(D, x, y, s) </span><span id="be08" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">    contrast = D[y,x,s] + .5*J.dot(offset) <br>    if abs(contrast) &lt; t_c: continue </span><span id="b285" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">    w, v = LA.eig(H) <br>    r = w[1]/w[0] <br>    R = (r+1)**2 / r <br>    if R &gt; R_th: continue </span><span id="e5ff" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">    kp = np.array([x, y, s]) + offset<br>    keypoints.append(kp)</span><span id="1be2" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">  return np.array(keypoints)</span></pre><p id="8040" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">I use the values from the paper for <code class="hs jr js jt jn b">t_c</code> and <code class="hs jr js jt jn b">R_th</code>, namely 0.03 and (10+1)²/10 respectively. The motivation for <code class="hs jr js jt jn b">R_th</code> is more clear in the paper.</p><p id="51d4" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">Now it is trivial to calculate the keypoints for the whole DoG pyramid:</p><pre class="hc hd he hf hg jk jl jm"><span id="e12f" class="it gl dc bk jn b eg jo jp r jq" data-selectable-paragraph="">def get_keypoints(DoG_pyr, R_th, t_c, w): <br>  kps = [] </span><span id="e212" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">  for D in DoG_pyr: <br>    kps.append(find_keypoints_for_DoG_octave(D, R_th, t_c, w)) </span><span id="c3c1" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">  return kps</span></pre></div></div></section><hr class="ga ef gb gc gd ge gf gg gh gi gj"><section class="cu cv cw cx cy"><div class="n p"><div class="ac ae af ag ah cz aj ak"><h1 id="d9b9" class="gk gl dc bk bj gm de gn dg go gp gq gr gs gt gu gv" data-selectable-paragraph="">Orientation Assignment</h1><p id="81e9" class="fm fn dc bk fo b fp gw fr gx ft gy fv gz fx ha fz cu" data-selectable-paragraph="">Getting the keypoints is only half the battle. Now we have to obtain the actual descriptors. But before we do so, we need to ensure another type of invariance: rotational.</p><p id="578a" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">We have translational invariance because we convolve our filters over the image. We also have scale invariance because of our use of the scale-normalized LoG filter. Now to impose rotational invariance, we assign the patch around each keypoint an orientation corresponding to its dominant gradient direction. This comes in handy later when we use the Histogram of Gradients descriptor to describe each patch.</p><p id="5300" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">To assign orientation, we take a patch around each keypoint thats size is proportional to the scale of that keypoint. We then create a histogram of the gradients for each pixel in that patch.</p><p id="9c46" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">The histogram is created on angle (the gradient is specified in polar coordinates) and has 36 bins (each bin has a width of 10 degrees). When the magnitude and angle of the gradient at a pixel is calculated, the corresponding bin in our histogram grows by the gradient magnitude weighted by the Gaussian window.</p><p id="1f9d" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">Once we have our histogram, we assign that keypoint the orientation of the maximal histogram bin.</p><h2 id="c3e8" class="it gl dc bk bj gm iu iv iw ix iy iz ja jb jc jd je" data-selectable-paragraph="">Implementation</h2><pre class="hc hd he hf hg jk jl jm"><span id="9b1f" class="it gl dc bk jn b eg jo jp r jq" data-selectable-paragraph="">def assign_orientation(kps, octave, num_bins=36): <br>  new_kps = [] <br>  bin_width = 360//num_bins </span><span id="5830" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">  for kp in kps: <br>    cx, cy, s = int(kp[0]), int(kp[1]), int(kp[2]) <br>    s = np.clip(s, 0, octave.shape[2]-1) <br>    sigma = kp[2]*1.5 <br>    w = int(2*np.ceil(sigma)+1) <br>    kernel = gaussian_filter(sigma) <br>    L = octave[…,s]<br>    hist = np.zeros(num_bins, dtype=np.float32) </span><span id="8925" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">    for oy in range(-w, w+1): <br>      for ox in range(-w, w+1): <br>        x, y = cx+ox, cy+oy <br>        if x &lt; 0 or x &gt; octave.shape[1]-1: continue <br>        elif y &lt; 0 or y &gt; octave.shape[0]-1: continue </span><span id="66ae" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">        m, theta = get_grad(L, x, y) <br>        weight = kernel[oy+w, ox+w] * m <br>        bin = quantize_orientation(theta, num_bins) <br>        hist[bin] += weight </span><span id="37f2" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">    max_bin = np.argmax(hist) <br>    new_kps.append([kp[0], kp[1], kp[2], fit_parabola(hist, max_bin, bin_width)]) <br>    max_val = np.max(hist) </span><span id="f5a1" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">    for binno, val in enumerate(hist): <br>      if binno == max_bin: continue <br>      if .8 * max_val &lt;= val: <br>        new_kps.append([kp[0], kp[1], kp[2], fit_parabola(hist, binno, bin_width)])</span><span id="4a82" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">  return np.array(new_kps)</span></pre><p id="ffe5" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">The one thing I want to mention about this function is the last loop. The paper specifies that for any histogram bin that has a value within 80% of the maximum value to create a new keypoint at that location and scale but with the new orientation.</p><p id="3cb6" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">The paper also says that you should fit a parabola to the three histogram values closest to the maximum, which is done in the following function:</p><pre class="hc hd he hf hg jk jl jm"><span id="a30d" class="it gl dc bk jn b eg jo jp r jq" data-selectable-paragraph="">def fit_parabola(hist, binno, bin_width): <br>  centerval = binno*bin_width + bin_width/2. </span><span id="2e8e" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">  if binno == len(hist)-1: rightval = 360 + bin_width/2. <br>  else: rightval = (binno+1)*bin_width + bin_width/2. </span><span id="5304" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">  if binno == 0: leftval = -bin_width/2. <br>  else: leftval = (binno-1)*bin_width + bin_width/2. </span><span id="4685" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">  A = np.array([ <br>    [centerval**2, centerval, 1], <br>    [rightval**2, rightval, 1], <br>    [leftval**2, leftval, 1]]) <br>  b = np.array([ <br>    hist[binno], <br>    hist[(binno+1)%len(hist)], <br>    hist[(binno-1)%len(hist)]]) </span><span id="46a5" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">  x = LA.lstsq(A, b, rcond=None)[0] <br>  if x[0] == 0: x[0] = 1e-6 <br>  return -x[1]/(2*x[0])</span></pre><p id="b3eb" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">We simply get the least squares solution where the center of the max histogram bin as well as its two adjacent bins are taken as the independent variable and the value at that histogram the dependent variable. Once the coefficients for the parabola have been found, just use -b/2a to get the refined orientation.</p><p id="9cdb" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">There are also a few functions not included in this code. First is <code class="hs jr js jt jn b">get_grads</code> , which gets the gradient in polar coordinates at a pixel in L:</p><pre class="hc hd he hf hg jk jl jm"><span id="fd3f" class="it gl dc bk jn b eg jo jp r jq" data-selectable-paragraph="">def cart_to_polar_grad(dx, dy): <br>  m = np.sqrt(dx**2 + dy**2) <br>  theta = (np.arctan2(dy, dx)+np.pi) * 180/np.pi <br>  return m, theta </span><span id="c828" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">def get_grad(L, x, y): <br>  dy = L[min(L.shape[0]-1, y+1),x] — L[max(0, y-1),x] <br>  dx = L[y,min(L.shape[1]-1, x+1)] — L[y,max(0, x-1)] <br>  return cart_to_polar_grad(dx, dy)</span></pre><p id="3774" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">Then there is <code class="hs jr js jt jn b">quantize_orientation</code>, which simply converts the continuous angle of the gradient to a histogram bin:</p><pre class="hc hd he hf hg jk jl jm"><span id="94c3" class="it gl dc bk jn b eg jo jp r jq" data-selectable-paragraph="">def quantize_orientation(theta, num_bins): <br>  bin_width = 360//num_bins <br>  return int(np.floor(theta)//bin_width)</span></pre><h1 id="3c0b" class="gk gl dc bk bj gm de kj dg kk gp kl gr km gt kn gv" data-selectable-paragraph="">Local Descriptor Creation</h1><p id="b3db" class="fm fn dc bk fo b fp gw fr gx ft gy fv gz fx ha fz cu" data-selectable-paragraph=""><em class="jh">Finally</em>, we can create the local descriptors for each keypoint. As previously mentioned, we use the Histogram of Gradients method to create a feature vector from the surroundings of each keypoint.</p><p id="b5d4" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">Specifically, a 16x16 patch is inspected around each keypoint. That patch is then split up into 16 4x4 subregions. The gradients (in polar coordinates) of each subregion are then binned into an 8-bin histogram. Finally, all of these histograms are concatenated into a 4x4x8=128 element long feature vector.</p><p id="1e26" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">This final feature vector is then normalized, thresholded, and renormalized to try and ensure invariance to minor lighting changes.</p><h2 id="4f8b" class="it gl dc bk bj gm iu iv iw ix iy iz ja jb jc jd je" data-selectable-paragraph="">Implementation</h2><pre class="hc hd he hf hg jk jl jm"><span id="9e18" class="it gl dc bk jn b eg jo jp r jq" data-selectable-paragraph="">def get_local_descriptors(kps, octave, w=16, num_subregion=4, num_bin=8): <br>  descs = [] <br>  bin_width = 360//num_bin</span><span id="c610" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">  for kp in kps: <br>    cx, cy, s = int(kp[0]), int(kp[1]), int(kp[2]) <br>    s = np.clip(s, 0, octave.shape[2]-1) <br>    kernel = gaussian_filter(w/6) # gaussian_filter multiplies sigma by 3 <br>    L = octave[…,s] </span><span id="6262" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">    t, l = max(0, cy-w//2), max(0, cx-w//2) <br>    b, r = min(L.shape[0], cy+w//2+1), min(L.shape[1], cx+w//2+1) <br>    patch = L[t:b, l:r] <br>    dx, dy = get_patch_grads(patch) </span><span id="92f6" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">    if dx.shape[0] &lt; w+1: <br>      if t == 0: kernel = kernel[kernel.shape[0]-dx.shape[0]:] <br>      else: kernel = kernel[:dx.shape[0]] <br>    if dx.shape[1] &lt; w+1: <br>      if l == 0: kernel = kernel[kernel.shape[1]-dx.shape[1]:] <br>      else: kernel = kernel[:dx.shape[1]] <br>    if dy.shape[0] &lt; w+1: <br>      if t == 0: kernel = kernel[kernel.shape[0]-dy.shape[0]:] <br>      else: kernel = kernel[:dy.shape[0]] <br>    if dy.shape[1] &lt; w+1: <br>      if l == 0: kernel = kernel[kernel.shape[1]-dy.shape[1]:] <br>      else: kernel = kernel[:dy.shape[1]] </span><span id="3b25" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">    m, theta = cart_to_polar_grad(dx, dy) <br>    dx, dy = dx*kernel, dy*kernel </span><span id="7d11" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">    subregion_w = w//num_subregion <br>    featvec = np.zeros(num_bin * num_subregion**2, dtype=np.float32) </span><span id="ba2d" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">    for i in range(0, subregion_w): <br>      for j in range(0, subregion_w): <br>        t, l = i*subregion_w, j*subregion_w <br>        b, r = min(L.shape[0], (i+1)*subregion_w), min(L.shape[1], (j+1)*subregion_w) </span><span id="4e4a" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">        hist = get_histogram_for_subregion(m[t:b, l:r].ravel(), theta[t:b, l:r].ravel(), num_bin, kp[3], bin_width, subregion_w) </span><span id="a3c6" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">        featvec[i*subregion_w*num_bin + j*num_bin:i*subregion_w*num_bin + (j+1)*num_bin] = hist.flatten() </span><span id="a8bf" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">    featvec /= max(1e-6, LA.norm(featvec))        <br>    featvec[featvec&gt;0.2] = 0.2        <br>    featvec /= max(1e-6, LA.norm(featvec))    <br>    descs.append(featvec)</span><span id="66a0" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">  return np.array(descs)</span></pre><p id="0ce1" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">The checks on the shape of <code class="hs jr js jt jn b">dx</code> and <code class="hs jr js jt jn b">dy</code> in the middle are to avoid out of bounds errors I was getting earlier. If either/or are smaller than <code class="hs jr js jt jn b">w+1</code> then cut off the Gaussian window accordingly to avoid shape mismatches.</p><p id="ca47" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">First, the polar gradients are computed for the whole patch. Then the histogram is created for each subregion. Once the histogram for each subregion has been concatenated, the entire feature vector is normalized, thresholded to be less than or equal to 0.2, and then renormalized.</p><p id="5abf" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">I’m not 100% certain on the motivation behind the thresholding and renormalization but I believe it helps provide invariance to nonlinear lighting changes.</p><p id="114b" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">To calculate the gradients across the patch:</p><pre class="hc hd he hf hg jk jl jm"><span id="505d" class="it gl dc bk jn b eg jo jp r jq" data-selectable-paragraph="">def get_patch_grads(p): <br>  r1 = np.zeros_like(p) <br>  r1[-1] = p[-1] <br>  r1[:-1] = p[1:] </span><span id="cfdf" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">  r2 = np.zeros_like(p) <br>  r2[0] = p[0] <br>  r2[1:] = p[:-1] </span><span id="dbdc" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">  dy = r1-r2 </span><span id="61b5" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">  r1[:,-1] = p[:,-1] <br>  r1[:,:-1] = p[:,1:] <br>  r2[:,0] = p[:,0] <br>  r2[:,1:] = p[:,:-1] </span><span id="4f71" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">  dx = r1-r2 </span><span id="03b9" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">  return dx, dy</span></pre><p id="5414" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">Just take the difference between the previous and current pixels. This is easier than doing the double-sided derivative as before. Then to create the histogram for each subregion:</p><pre class="hc hd he hf hg jk jl jm"><span id="2ed7" class="it gl dc bk jn b eg jo jp r jq" data-selectable-paragraph="">def get_histogram_for_subregion(m, theta, num_bin, reference_angle, bin_width, subregion_w): <br>  hist = np.zeros(num_bin, dtype=np.float32) <br>  c = subregion_w/2 - .5</span><span id="ca63" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">  for mag, angle in zip(m, theta):<br>    angle = (angle-reference_angle) % 360        <br>    binno = quantize_orientation(angle, num_bin)        <br>    vote = mag      <br>   <br>    hist_interp_weight = 1 - abs(angle - (binno*bin_width + bin_width/2))/(bin_width/2)        <br>    vote *= max(hist_interp_weight, 1e-6)         </span><span id="9344" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">    gy, gx = np.unravel_index(i, (subregion_w, subregion_w))        <br>    x_interp_weight = max(1 - abs(gx - c)/c, 1e-6)            <br>    y_interp_weight = max(1 - abs(gy - c)/c, 1e-6)        <br>    vote *= x_interp_weight * y_interp_weight         </span><span id="bafe" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">    hist[binno] += vote</span><span id="77fb" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">  hist /= max(1e-6, LA.norm(hist)) <br>  hist[hist&gt;0.2] = 0.2 <br>  hist /= max(1e-6, LA.norm(hist))<br>  return hist</span></pre><p id="4abb" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">The code is fairly similar to the previous HoG code however we perform trilinear interpolation on each entry into the histogram. This interpolation is to provide robustness for when a gradient at a pixel either goes from one bin to the other or is at the edge of a subregion and goes into a different subregion.</p><p id="0ac2" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">Therefore, the weight of an entry is proportional to 1-(distance from the center of the bin) and well as 1-(distance from the center of the subregion) for both the x and y directions. The spatial (x and y) interpolation is the only thing I am not sure about because I could not find a reliable source on it.</p></div></div></section><hr class="ga ef gb gc gd ge gf gg gh gi gj"><section class="cu cv cw cx cy"><div class="n p"><div class="ac ae af ag ah cz aj ak"><h1 id="766d" class="gk gl dc bk bj gm de gn dg go gp gq gr gs gt gu gv" data-selectable-paragraph="">Putting it All Together</h1><p id="b566" class="fm fn dc bk fo b fp gw fr gx ft gy fv gz fx ha fz cu" data-selectable-paragraph="">We can now create a <code class="hs jr js jt jn b">SIFT</code> object to encapsulate all of the above operations:</p><pre class="hc hd he hf hg jk jl jm"><span id="ca92" class="it gl dc bk jn b eg jo jp r jq" data-selectable-paragraph="">class SIFT(object): <br>  def __init__(self, im, s=3, num_octave=4, s0=1.3, sigma=1.6, r_th=10, t_c=0.03, w=16): <br>    self.im = convolve(rgb2gray(im), gaussian_filter(s0)) <br>    self.s = s <br>    self.sigma = sigma <br>    self.num_octave = num_octave<br>    self.t_c = t_c <br>    self.R_th = (r_th+1)**2 / r_th <br>    self.w = w </span><span id="0522" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">  def get_features(self): <br>    gaussian_pyr = generate_gaussian_pyramid(self.im, self.num_octave, self.s, self.sigma) <br>    DoG_pyr = generate_DoG_pyramid(gaussian_pyr) <br>    kp_pyr = get_keypoints(DoG_pyr, self.R_th, self.t_c, self.w) <br>    feats = [] </span><span id="8faa" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">    for i, DoG_octave in enumerate(DoG_pyr): kp_pyr[i] = <br>      assign_orientation(kp_pyr[i], DoG_octave) <br>      feats.append(get_local_descriptors(kp_pyr[i], DoG_octave)) </span><span id="067e" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">    self.kp_pyr = kp_pyr <br>    self.feats = feats </span><span id="10ea" class="it gl dc bk jn b eg ju jv jw jx jy jp r jq" data-selectable-paragraph="">    return feats</span></pre><p id="c2f3" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">One final small detail is that I blur the initial image with a sigma of 1.3. I did not see this in the paper but I saw it in a few implementations.</p></div></div></section><hr class="ga ef gb gc gd ge gf gg gh gi gj"><section class="cu cv cw cx cy"><div class="n p"><div class="ac ae af ag ah cz aj ak"><h1 id="2f03" class="gk gl dc bk bj gm de gn dg go gp gq gr gs gt gu gv" data-selectable-paragraph="">Conclusion</h1><p id="eef1" class="fm fn dc bk fo b fp gw fr gx ft gy fv gz fx ha fz cu" data-selectable-paragraph="">I know this has been really long and probably not all that clear in places, but I hope you learned something about both the theory and how to implement SIFT.</p><p id="5170" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">I’m aware that this is not a perfect implementation and nor does it implement every detail from the paper, but it empirically seems to work pretty well, whatever that means.</p><p id="52ab" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu" data-selectable-paragraph="">If you’re curious, here is a link to the complete repository (even though almost all the code is here): <a href="https://github.com/SamL98/PySIFT" class="at cg ie if ig ih" target="_blank" rel="noopener nofollow">https://github.com/SamL98/PySIFT</a></p></div></div></section></div></article><div class="nr ct ko s ak kv kt kw" data-test-id="post-sidebar"><div class="n p"><div class="ac ae af ag ah ai aj ak"><div class="kx n co"><div class="rr"><div class="ky kz la n"><div class="n o"><div class="lb r hk"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40lerner98%2Fimplementing-sift-in-python-36c619df7945&amp;source=post_sidebar-----36c619df7945---------------------clap_sidebar-" class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" rel="noopener"><div class="ba lc ld le lf lg lh li lj lk ll"><svg width="29" height="29"><g fill-rule="evenodd"><path d="M13.74 1l.76 2.97.76-2.97zM16.82 4.78l1.84-2.56-1.43-.47zM10.38 2.22l1.84 2.56-.41-3.03zM22.38 22.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M9.1 22.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L6.1 15.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L6.4 11.26l-1.18-1.18a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L11.96 14a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L8.43 9.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L20.63 15c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM13 6.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 23 23.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></div><div class="lm r"><div class="ln"><h4 class="bj ef eg bl bo"><button class="at au av aw ax ay az ba bb bc bd be bf bg bh bi">230 </button></h4></div></div></div></div><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40lerner98%2Fimplementing-sift-in-python-36c619df7945&amp;source=post_sidebar--------------------------bookmark_sidebar-" class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></div></div></div></div></div><div class="nr rr ko s kp kq kr ks kt ku"></div><div><div class="lo hh n co p"><div class="n p"><div class="ac ae af ag ah cz aj ak"><div class="n lp"></div><div class="n o lp"></div><div class="lq r"><ul class="ba bb"><li class="cf lr ls lt"><a href="https://medium.com/tag/computer-vision" class="lu lv cg bo r jl lw a b fb">Computer Vision</a></li><li class="cf lr ls lt"><a href="https://medium.com/tag/sift" class="lu lv cg bo r jl lw a b fb">Sift</a></li><li class="cf lr ls lt"><a href="https://medium.com/tag/python" class="lu lv cg bo r jl lw a b fb">Python</a></li></ul></div><div class="lx n dv ab"><div class="n o"><div class="ly r hk"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40lerner98%2Fimplementing-sift-in-python-36c619df7945&amp;source=post_actions_footer-----36c619df7945---------------------clap_footer-" class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" rel="noopener"><div class="c lz dz n o ma hk mb mc md me mf mg mh mi mj mk ml mm mn mo"><div class="ba lc ld le lf lg mp li o hx dz n p mq u ho cp t ak lj lk ll mr"><svg width="33" height="33" viewBox="0 0 33 33"><path d="M28.86 17.34l-3.64-6.4c-.3-.43-.71-.73-1.16-.8a1.12 1.12 0 0 0-.9.21c-.62.5-.73 1.18-.32 2.06l1.22 2.6 1.4 2.45c2.23 4.09 1.51 8-2.15 11.66a9.6 9.6 0 0 1-.8.71 6.53 6.53 0 0 0 4.3-2.1c3.82-3.82 3.57-7.87 2.05-10.39zm-6.25 11.08c3.35-3.35 4-6.78 1.98-10.47L21.2 12c-.3-.43-.71-.72-1.16-.8a1.12 1.12 0 0 0-.9.22c-.62.49-.74 1.18-.32 2.06l1.72 3.63a.5.5 0 0 1-.81.57l-8.91-8.9a1.33 1.33 0 0 0-1.89 1.88l5.3 5.3a.5.5 0 0 1-.71.7l-5.3-5.3-1.49-1.49c-.5-.5-1.38-.5-1.88 0a1.34 1.34 0 0 0 0 1.89l1.49 1.5 5.3 5.28a.5.5 0 0 1-.36.86.5.5 0 0 1-.36-.15l-5.29-5.29a1.34 1.34 0 0 0-1.88 0 1.34 1.34 0 0 0 0 1.89l2.23 2.23L9.3 21.4a.5.5 0 0 1-.36.85.5.5 0 0 1-.35-.14l-3.32-3.33a1.33 1.33 0 0 0-1.89 0 1.32 1.32 0 0 0-.39.95c0 .35.14.69.4.94l6.39 6.4c3.53 3.53 8.86 5.3 12.82 1.35zM12.73 9.26l5.68 5.68-.49-1.04c-.52-1.1-.43-2.13.22-2.89l-3.3-3.3a1.34 1.34 0 0 0-1.88 0 1.33 1.33 0 0 0-.4.94c0 .22.07.42.17.61zm14.79 19.18a7.46 7.46 0 0 1-6.41 2.31 7.92 7.92 0 0 1-3.67.9c-3.05 0-6.12-1.63-8.36-3.88l-6.4-6.4A2.31 2.31 0 0 1 2 19.72a2.33 2.33 0 0 1 1.92-2.3l-.87-.87a2.34 2.34 0 0 1 0-3.3 2.33 2.33 0 0 1 1.24-.64l-.14-.14a2.34 2.34 0 0 1 0-3.3 2.39 2.39 0 0 1 3.3 0l.14.14a2.33 2.33 0 0 1 3.95-1.24l.09.09c.09-.42.29-.83.62-1.16a2.34 2.34 0 0 1 3.3 0l3.38 3.39a2.17 2.17 0 0 1 1.27-.17c.54.08 1.03.35 1.45.76.1-.55.41-1.03.9-1.42a2.12 2.12 0 0 1 1.67-.4 2.8 2.8 0 0 1 1.85 1.25l3.65 6.43c1.7 2.83 2.03 7.37-2.2 11.6zM13.22.48l-1.92.89 2.37 2.83-.45-3.72zm8.48.88L19.78.5l-.44 3.7 2.36-2.84zM16.5 3.3L15.48 0h2.04L16.5 3.3z" fill-rule="evenodd"></path></svg></div></div></a></div><div class="lm r"><div class="ln"><h4 class="bj ef eg bl dc"><button class="at au av aw ax ay az ba bb bc bd be bf bg bh bi">230 claps</button></h4></div></div></div><div class="n o"><div class="fk r ar"><a href="https://medium.com/p/36c619df7945/share/twitter?source=post_actions_footer---------------------------" class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" target="_blank" rel="noopener nofollow"><svg width="29" height="29" class="q"><path d="M22.05 7.54a4.47 4.47 0 0 0-3.3-1.46 4.53 4.53 0 0 0-4.53 4.53c0 .35.04.7.08 1.05A12.9 12.9 0 0 1 5 6.89a5.1 5.1 0 0 0-.65 2.26c.03 1.6.83 2.99 2.02 3.79a4.3 4.3 0 0 1-2.02-.57v.08a4.55 4.55 0 0 0 3.63 4.44c-.4.08-.8.13-1.21.16l-.81-.08a4.54 4.54 0 0 0 4.2 3.15 9.56 9.56 0 0 1-5.66 1.94l-1.05-.08c2 1.27 4.38 2.02 6.94 2.02 8.3 0 12.86-6.9 12.84-12.85.02-.24 0-.43 0-.65a8.68 8.68 0 0 0 2.26-2.34c-.82.38-1.7.62-2.6.72a4.37 4.37 0 0 0 1.95-2.51c-.84.53-1.81.9-2.83 1.13z"></path></svg></a></div><div class="fk r ar"><a href="https://medium.com/p/36c619df7945/share/facebook?source=post_actions_footer---------------------------" class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" target="_blank" rel="noopener nofollow"><svg width="29" height="29" class="q"><path d="M23.2 5H5.8a.8.8 0 0 0-.8.8V23.2c0 .44.35.8.8.8h9.3v-7.13h-2.38V13.9h2.38v-2.38c0-2.45 1.55-3.66 3.74-3.66 1.05 0 1.95.08 2.2.11v2.57h-1.5c-1.2 0-1.48.57-1.48 1.4v1.96h2.97l-.6 2.97h-2.37l.05 7.12h5.1a.8.8 0 0 0 .79-.8V5.8a.8.8 0 0 0-.8-.79"></path></svg></a></div><div class="fk r ar"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40lerner98%2Fimplementing-sift-in-python-36c619df7945&amp;source=post_actions_footer--------------------------bookmark_sidebar-" class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></div><div class="cf" aria-hidden="true"><div class="r ar"><button class="at au av aw ax ay az ba bb bc bd be bf bg bh bi"><svg width="25" height="25" viewBox="-480.5 272.5 21 21" class="q"><path d="M-463 284.6c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5z"></path></svg></button></div></div></div></div><div class="ms mt mu lq r ab"><div class="mv mw r hk"><span class="r mx an my"><div class="r cp mz na"><a rel="noopener" href="https://medium.com/@lerner98?source=follow_footer--------------------------follow_footer-"><img alt="Sam Lerner" class="r dz nb nc" src="./Implementing SIFT in Python - Sam Lerner - Medium_files/1_IE48KfS1qALgA-1G_tvGpQ(1).png" width="80" height="80"></a></div><span class="r"><div class="nd r ne"><p class="bj ef fb bl bo nf ng">Written by</p></div><div class="nd nh n ne"><div class="ak n o dv"><h2 class="bj gm gb ni dc"><a class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" rel="noopener" href="https://medium.com/@lerner98?source=follow_footer--------------------------follow_footer-">Sam Lerner</a></h2><div class="r g"><button class="nj dc q by eq er es et bc bh eu ev ew ex ey ez cb bj b bk bl bm bn cc cd ce cf cg bf">Follow</button></div></div></div></span></span><div class="nd nk r ne aq"><div class="nl r"><h4 class="bj ef nm nn bo">Computer science enthusiast</h4></div><div class="ap no aq"><button class="nj dc q by eq er es et bc bh eu ev ew ex ey ez cb bj b bk bl bm bn cc cd ce cf cg bf">Follow</button></div></div></div></div><div class="np mt r ab"><a href="https://medium.com/p/36c619df7945/responses/show?source=follow_footer--------------------------follow_footer-" class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" rel="noopener"><span class="nq nr lf"><div class="jk ns cb r ge aq"><span class="br">See responses (1)</span></div></span></a></div></div></div><div class="nt r nu ab"><div class="n p"><div class="ac ae af ag ah ai aj ak"><div class="tp r tq"><div class="pf tr mv r"><h2 class="bj gm ts tt dc">More From Medium</h2></div><div class="tu n qg lp tv tw tx ty tz ua ub uc ud ue uf ug uh ui uj"><div class="uk ul um un uo up uq ur us ut uu uv uw ux uy uz va vb vc vd ve"><div class="ak ho"><div class="r vf"><div class="vg vh tv tw tx vi vj ty tz ua vk vl ub uc ud vm vn ue uf ug vo vp uh ui uj n lp"><div class="uk ul um un uo up vq vr us ut vs vt uw ux vu vv va vb vw vx ve"><div class="ro r vy f"><h4 class="bj ef eg bl bo">More from Sam Lerner</h4></div><div class="vz r wa tq"><a class="at au av aw ax ay az ba bb bc bd be bf bg bh bi r" rel="noopener" href="https://medium.com/@lerner98/creating-a-clap-controlled-arduino-remote-8a9effdd37ff?source=post_recirc---------0------------------"><div class="wb hk"><div class="ho cp ak"><div class="wc r wd we ho ak wf wg"></div></div></div></a></div></div><div class="uk ul um un uo up vq vr us ut vs vt uw ux vu vv va vb vw vx ve"><div class="vz r"><div class="wh ap h wi"><h4 class="bj ef eg bl bo">More from Sam Lerner</h4></div><a rel="noopener" href="https://medium.com/@lerner98/creating-a-clap-controlled-arduino-remote-8a9effdd37ff?source=post_recirc---------0------------------"><h3 class="dc q dd qp bk wj wk wl">Creating a Clap-Controlled Arduino Remote</h3></a></div><div class="n o dv"><div class="wm r wn"><div class="o n"><div><a rel="noopener" href="https://medium.com/@lerner98?source=post_recirc---------0------------------"><img alt="Sam Lerner" class="r dz wo wp" src="./Implementing SIFT in Python - Sam Lerner - Medium_files/1_IE48KfS1qALgA-1G_tvGpQ(2).png" width="40" height="40"></a></div><div class="ec ak r"><div class="n"><div style="flex: 1 1 0%;"><span class="bj b bk bl bm bn r dc q"><div class="ch n o ee"><span class="bj ef eg bl eh ei ej ek el em dc"><a class="at au av aw ax ay az ba bb bc en bf bg bh bi" rel="noopener" href="https://medium.com/@lerner98?source=post_recirc---------0------------------">Sam Lerner</a></span></div></span></div></div><span class="bj b bk bl bm bn r bo bp"><span class="bj ef eg bl eh ei ej ek el em bo"><div><a class="at au av aw ax ay az ba bb bc en bf bg bh bi" rel="noopener" href="https://medium.com/@lerner98/creating-a-clap-controlled-arduino-remote-8a9effdd37ff?source=post_recirc---------0------------------">Dec 30, 2018</a> · 18 min read</div></span></span></div></div></div><div class="n o"><div class="n o"><div class="lb r hk"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40lerner98%2Fimplementing-sift-in-python-36c619df7945&amp;source=post_recirc-----8a9effdd37ff----0-----------------clap_preview-" class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" rel="noopener"><div class="ba lc ld le lf lg lh pj lj lk ll"><svg width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></div><div class="lm r"><div class="ln"><h4 class="bj ef eg bl bo">139 </h4></div></div></div><div class="wq ec wm wr ta r"></div><div><div class="cf" role="tooltip" aria-hidden="true" aria-describedby="1" aria-labelledby="1"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40lerner98%2Fimplementing-sift-in-python-36c619df7945&amp;source=post_recirc---------0-----------------bookmark_sidebar-" class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></div></div></div></div></div></div></div></div></div><div class="uk ul um un uo up uq ur us ut uu uv uw ux uy uz va vb vc vd ve"><div class="ak ho"><div class="r vf"><div class="vg vh tv tw tx vi vj ty tz ua vk vl ub uc ud vm vn ue uf ug vo vp uh ui uj n lp"><div class="uk ul um un uo up vq vr us ut vs vt uw ux vu vv va vb vw vx ve"><div class="ro r vy f"><h4 class="bj ef eg bl bo">Related reads</h4></div><div class="vz r wa tq"><a href="https://towardsdatascience.com/bag-of-visual-words-in-a-nutshell-9ceea97ce0fb?source=post_recirc---------1------------------" class="at au av aw ax ay az ba bb bc bd be bf bg bh bi r" rel="noopener"><div class="wb hk"><div class="ho cp ak"><div class="ws r wd we ho ak wf wg"></div></div></div></a></div></div><div class="uk ul um un uo up vq vr us ut vs vt uw ux vu vv va vb vw vx ve"><div class="vz r"><div class="wh ap h wi"><h4 class="bj ef eg bl bo">Related reads</h4></div><a href="https://towardsdatascience.com/bag-of-visual-words-in-a-nutshell-9ceea97ce0fb?source=post_recirc---------1------------------" rel="noopener"><h3 class="dc q dd qp bk wj wk wl">Bag of Visual Words in a Nutshell</h3></a></div><div class="n o dv"><div class="wm r wn"><div class="o n"><div><a rel="noopener" href="https://medium.com/@betheazdavida?source=post_recirc---------1------------------"><img alt="Bethea Davida" class="r dz wo wp" src="./Implementing SIFT in Python - Sam Lerner - Medium_files/1_rHTBieEKvvqz6TdlOc0uaQ.jpeg" width="40" height="40"></a></div><div class="ec ak r"><div class="n"><div style="flex: 1 1 0%;"><span class="bj b bk bl bm bn r dc q"><div class="ch n o ee"><span class="bj ef eg bl eh ei ej ek el em dc"><a class="at au av aw ax ay az ba bb bc en bf bg bh bi" rel="noopener" href="https://medium.com/@betheazdavida?source=post_recirc---------1------------------">Bethea Davida</a><span> in <a href="https://towardsdatascience.com/?source=post_recirc---------1------------------" class="at au av aw ax ay az ba bb bc en bf bg bh bi" rel="noopener">Towards Data Science</a></span></span></div></span></div></div><span class="bj b bk bl bm bn r bo bp"><span class="bj ef eg bl eh ei ej ek el em bo"><div><a href="https://towardsdatascience.com/bag-of-visual-words-in-a-nutshell-9ceea97ce0fb?source=post_recirc---------1------------------" class="at au av aw ax ay az ba bb bc en bf bg bh bi" rel="noopener">Jul 3, 2018</a> · 3 min read</div></span></span></div></div></div><div class="n o"><div class="n o"><div class="lb r hk"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40lerner98%2Fimplementing-sift-in-python-36c619df7945&amp;source=post_recirc-----9ceea97ce0fb----1-----------------clap_preview-" class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" rel="noopener"><div class="ba lc ld le lf lg lh pj lj lk ll"><svg width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></div><div class="lm r"><div class="ln"><h4 class="bj ef eg bl bo">369 </h4></div></div></div><div class="wq ec wm wr ta r"></div><div><div class="cf" role="tooltip" aria-hidden="true" aria-describedby="2" aria-labelledby="2"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40lerner98%2Fimplementing-sift-in-python-36c619df7945&amp;source=post_recirc---------1-----------------bookmark_sidebar-" class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></div></div></div></div></div></div></div></div></div><div class="uk ul um un uo up uq ur us ut uu uv uw ux uy uz va vb vc vd ve"><div class="ak ho"><div class="r vf"><div class="vg vh tv tw tx vi vj ty tz ua vk vl ub uc ud vm vn ue uf ug vo vp uh ui uj n lp"><div class="uk ul um un uo up vq vr us ut vs vt uw ux vu vv va vb vw vx ve"><div class="ro r vy f"><h4 class="bj ef eg bl bo">Related reads</h4></div><div class="vz r wa tq"><a href="https://towardsdatascience.com/image-segmentation-using-pythons-scikit-image-module-533a61ecc980?source=post_recirc---------2------------------" class="at au av aw ax ay az ba bb bc bd be bf bg bh bi r" rel="noopener"><div class="wb hk"><div class="ho cp ak"><div class="wt r wd we ho ak wf wg"></div></div></div></a></div></div><div class="uk ul um un uo up vq vr us ut vs vt uw ux vu vv va vb vw vx ve"><div class="vz r"><div class="wh ap h wi"><h4 class="bj ef eg bl bo">Related reads</h4></div><a href="https://towardsdatascience.com/image-segmentation-using-pythons-scikit-image-module-533a61ecc980?source=post_recirc---------2------------------" rel="noopener"><h3 class="dc q dd qp bk wj wk wl">Image Segmentation using Python’s scikit-image module</h3></a></div><div class="n o dv"><div class="wm r wn"><div class="o n"><div><a rel="noopener" href="https://medium.com/@parulnith?source=post_recirc---------2------------------"><img alt="Parul Pandey" class="r dz wo wp" src="./Implementing SIFT in Python - Sam Lerner - Medium_files/1_-ooorT2_5GQSfQoVFxJHXw.jpeg" width="40" height="40"></a></div><div class="ec ak r"><div class="n"><div style="flex: 1 1 0%;"><span class="bj b bk bl bm bn r dc q"><div class="ch n o ee"><span class="bj ef eg bl eh ei ej ek el em dc"><a class="at au av aw ax ay az ba bb bc en bf bg bh bi" rel="noopener" href="https://medium.com/@parulnith?source=post_recirc---------2------------------">Parul Pandey</a><span> in <a href="https://towardsdatascience.com/?source=post_recirc---------2------------------" class="at au av aw ax ay az ba bb bc en bf bg bh bi" rel="noopener">Towards Data Science</a></span></span></div></span></div></div><span class="bj b bk bl bm bn r bo bp"><span class="bj ef eg bl eh ei ej ek el em bo"><div><a href="https://towardsdatascience.com/image-segmentation-using-pythons-scikit-image-module-533a61ecc980?source=post_recirc---------2------------------" class="at au av aw ax ay az ba bb bc en bf bg bh bi" rel="noopener">Feb 16, 2019</a> · 11 min read</div></span></span></div></div></div><div class="n o"><div class="n o"><div class="lb r hk"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40lerner98%2Fimplementing-sift-in-python-36c619df7945&amp;source=post_recirc-----533a61ecc980----2-----------------clap_preview-" class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" rel="noopener"><div class="ba lc ld le lf lg lh pj lj lk ll"><svg width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></div><div class="lm r"><div class="ln"><h4 class="bj ef eg bl bo">1.4K </h4></div></div></div><div class="wq ec wm wr ta r"></div><div><div class="cf" role="tooltip" aria-hidden="true" aria-describedby="3" aria-labelledby="3"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40lerner98%2Fimplementing-sift-in-python-36c619df7945&amp;source=post_recirc---------2-----------------bookmark_sidebar-" class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="nv r nw nx"><section class="cl cm ak ce r ny nz oa ob oc od oe of og oh oi oj ok ol om"><div class="on oo mv n dv g"><div class="op n dv"><div class="oq r or"><div class="os r"><a href="https://medium.com/about?autoplay=1&amp;source=post_page-----36c619df7945----------------------" class="at au av aw ax ay az ba bb bc ot ou bf bg ov ow" rel="noopener"><h4 class="ox oy oz bj gm bk nn pa pb r">Discover <!-- -->Medium</h4></a></div><span class="bj b bk bl bm bn r pc pd">Welcome to a place where words matter. On <!-- -->Medium<!-- -->, smart voices and original ideas take center stage - with no ads in sight.<!-- --> <a href="https://medium.com/about?autoplay=1&amp;source=post_page-----36c619df7945----------------------" class="at au av aw ax ay az ba bb bc bf bg ov ow pe" rel="noopener">Watch</a></span></div><div class="oq r or"><div class="pf r"><a href="https://medium.com/topics?source=post_page-----36c619df7945----------------------" class="at au av aw ax ay az ba bb bc ot ou bf bg ov ow" rel="noopener"><h4 class="ox oy oz bj gm bk nn pa pb r">Make <!-- -->Medium<!-- --> yours</h4></a></div><span class="bj b bk bl bm bn r pc pd">Follow all the topics you care about, and we’ll deliver the best stories for you to your homepage and inbox.<!-- --> <a href="https://medium.com/topics?source=post_page-----36c619df7945----------------------" class="at au av aw ax ay az ba bb bc bf bg ov ow pe" rel="noopener">Explore</a></span></div><div class="oq r or"><div class="os r"><a href="https://medium.com/membership?source=post_page-----36c619df7945----------------------" class="at au av aw ax ay az ba bb bc ot ou bf bg ov ow" rel="noopener"><h4 class="ox oy oz bj gm bk nn pa pb r">Become a member</h4></a></div><span class="bj b bk bl bm bn r pc pd">Get unlimited access to the best stories on <!-- -->Medium<!-- --> — and support writers while you’re at it. Just $5/month.<!-- --> <a href="https://medium.com/membership?source=post_page-----36c619df7945----------------------" class="at au av aw ax ay az ba bb bc bf bg ov ow pe" rel="noopener">Upgrade</a></span></div></div></div><div class="n o dv"><a class="at au av aw ax ay az ba bb bc ot ou bf bg ov ow" rel="noopener" href="https://medium.com/?source=post_page-----36c619df7945----------------------"><svg height="22" width="112" viewBox="0 0 111.5 22" class="oy"><path d="M56.3 19.5c0 .4 0 .5.3.7l1.5 1.4v.1h-6.5V19c-.7 1.8-2.4 3-4.3 3-3.3 0-5.8-2.6-5.8-7.5 0-4.5 2.6-7.6 6.3-7.6 1.6-.1 3.1.8 3.8 2.4V3.2c0-.3-.1-.6-.3-.7l-1.4-1.4V1l6.5-.8v19.3zm-4.8-.8V9.5c-.5-.6-1.2-.9-1.9-.9-1.6 0-3.1 1.4-3.1 5.7 0 4 1.3 5.4 3 5.4.8.1 1.6-.3 2-1zm9.1 3.1V9.4c0-.3-.1-.6-.3-.7l-1.4-1.5v-.1h6.5v12.5c0 .4 0 .5.3.7l1.4 1.4v.1h-6.5zm-.2-19.2C60.4 1.2 61.5 0 63 0c1.4 0 2.6 1.2 2.6 2.6S64.4 5.3 63 5.3a2.6 2.6 0 0 1-2.6-2.7zm22.5 16.9c0 .4 0 .5.3.7l1.5 1.4v.1h-6.5v-3.2c-.6 2-2.4 3.4-4.5 3.4-2.9 0-4.4-2.1-4.4-6.2 0-1.9 0-4.1.1-6.5 0-.3-.1-.5-.3-.7L67.7 7v.1H74v8c0 2.6.4 4.4 2 4.4.9-.1 1.7-.6 2.1-1.3V9.5c0-.3-.1-.6-.3-.7l-1.4-1.5v-.2h6.5v12.4zm22 2.3c0-.5.1-6.5.1-7.9 0-2.6-.4-4.5-2.2-4.5-.9 0-1.8.5-2.3 1.3.2.8.3 1.7.3 2.5 0 1.8-.1 4.2-.1 6.5 0 .3.1.5.3.7l1.5 1.4v.1H96c0-.4.1-6.5.1-7.9 0-2.7-.4-4.5-2.2-4.5-.9 0-1.7.5-2.2 1.3v9c0 .4 0 .5.3.7l1.4 1.4v.1h-6.5V9.5c0-.3-.1-.6-.3-.7l-1.4-1.5v-.2h6.5v3.1a4.6 4.6 0 0 1 4.6-3.4c2.2 0 3.6 1.2 4.2 3.5.7-2.1 2.7-3.6 4.9-3.5 2.9 0 4.5 2.2 4.5 6.2 0 1.9-.1 4.2-.1 6.5-.1.3.1.6.3.7l1.4 1.4v.1h-6.6zm-81.4-2l1.9 1.9v.1h-9.8v-.1l2-1.9c.2-.2.3-.4.3-.7V7.3c0-.5 0-1.2.1-1.8L11.4 22h-.1L4.5 6.8c-.1-.4-.2-.4-.3-.6v10c-.1.7 0 1.3.3 1.9l2.7 3.6v.1H0v-.1L2.7 18c.3-.6.4-1.3.3-1.9v-11c0-.5-.1-1.1-.5-1.5L.7 1.1V1h7l5.8 12.9L18.6 1h6.8v.1l-1.9 2.2c-.2.2-.3.5-.3.7v15.2c0 .2.1.5.3.6zm7.6-5.9c0 3.8 1.9 5.3 4.2 5.3 1.9.1 3.6-1 4.4-2.7h.1c-.8 3.7-3.1 5.5-6.5 5.5-3.7 0-7.2-2.2-7.2-7.4 0-5.5 3.5-7.6 7.3-7.6 3.1 0 6.4 1.5 6.4 6.2v.8h-8.7zm0-.8h4.3v-.8c0-3.9-.8-4.9-2-4.9-1.4.1-2.3 1.6-2.3 5.7z"></path></svg></a><span class="bj b bk bl bm bn r pc pd"><div class="pg ph n dv pi an"><a href="https://medium.com/about?autoplay=1&amp;source=post_page-----36c619df7945----------------------" class="at au av aw ax ay az ba bb bc en bf bg ov ow" rel="noopener">About</a><a href="https://help.medium.com/?source=post_page-----36c619df7945----------------------" class="at au av aw ax ay az ba bb bc en bf bg ov ow" rel="noopener">Help</a><a class="at au av aw ax ay az ba bb bc en bf bg ov ow" rel="noopener" href="https://medium.com/policy/9db0094a1e0f?source=post_page-----36c619df7945----------------------">Legal</a></div></span></div></section></div></div></div><script src="./Implementing SIFT in Python - Sam Lerner - Medium_files/16180790160.js.download"></script><iframe src="./Implementing SIFT in Python - Sam Lerner - Medium_files/a16180790160.html" hidden="" aria-hidden="true" tabindex="-1" title="Optimizely Internal Frame" height="0" width="0" style="display: none;"></iframe><script>window.__BUILD_ID__ = "development"</script><script>window.__GRAPHQL_URI__ = "https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"config":{"nodeEnv":"production","version":"master-20200207-221127-d173479dd0","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","lightStep":{"name":"lite-web","host":"collector-medium.lightstep.com","token":"ce5be895bef60919541332990ac9fef2","appVersion":"master-20200207-221127-d173479dd0"},"algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","sentry":{"dsn":"https:\u002F\u002F589e367c28ca47b195ce200d1507d18b@sentry.io\u002F1423575","environment":"production"},"isAmp":false,"googleAnalyticsCode":"UA-24232453-2","signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumOwnedAndOperatedCollectionIds":["544c7006046e","bcc38c8f6edf","444d13b52878","8d6b8a439e32","92d2092dc598","1285ba81cada","cb8577c9149e","8ccfed20cbb2","ae2a65f35510","3f6ecf56618","7b6769f2748b","fc8964313712","ef8e90590e66","191186aaafa0","d944778ce714","bdc4052bbdba","88d9857e584e"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"1*OMF3fSqH8t4xBJ9-6oZDZw.png","height":106,"width":545},"postLogo":{"imageId":"1*3sela1OADrJr7dJk_CXaEQ.png","height":810,"width":1440}},"performanceTags":[]},"debug":{"requestId":"832aace8-73a7-4871-ae26-49ccb44cc865","originalSpanCarrier":{"ot-tracer-spanid":"152094ab10a865f6","ot-tracer-traceid":"5ad8776854f50e8a","ot-tracer-sampled":"true"}},"session":{"user":{"id":"lo_12815307cc3b"},"xsrf":""},"stats":{"itemCount":0,"sending":false,"timeout":null,"backup":{}},"navigation":{"showBranchBanner":null,"hasRenderedBranchBanner":null,"hideGoogleOneTap":false,"hasRenderedGoogleOneTap":null,"branchData":{"loaded":false},"currentLocation":"https:\u002F\u002Fmedium.com\u002F@lerner98\u002Fimplementing-sift-in-python-36c619df7945","host":"medium.com","hostname":"medium.com","referrer":"https:\u002F\u002Fwww.google.com\u002F","susiModal":{"step":null,"operation":"register","reportEventInfo":{"eventName":"","data":{}}}},"client":{"isBot":false,"isEu":false,"isLinkedin":false,"isNativeMedium":false,"isCustomDomain":false},"multiVote":{"clapsPerPost":{}},"metadata":{"faviconImageId":null}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY.variantFlags.0":{"name":"add_friction_to_signup","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.0.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.0.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.1":{"name":"allow_access","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.1.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.1.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.2":{"name":"allow_signup","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.2.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.2.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.3":{"name":"allow_test_auth","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.3.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.3.valueType":{"__typename":"VariantFlagString","value":"disallow"},"ROOT_QUERY.variantFlags.4":{"name":"assign_default_topic_to_posts","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.4.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.4.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.5":{"name":"available_annual_plan","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.5.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.5.valueType":{"__typename":"VariantFlagString","value":"2c754bcc2995"},"ROOT_QUERY.variantFlags.6":{"name":"available_monthly_plan","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.6.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.6.valueType":{"__typename":"VariantFlagString","value":"60e220181034"},"ROOT_QUERY.variantFlags.7":{"name":"branch_seo_metadata","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.7.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.7.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.8":{"name":"browsable_stream_config_bucket","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.8.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.8.valueType":{"__typename":"VariantFlagString","value":"curated-topics"},"ROOT_QUERY.variantFlags.9":{"name":"disable_android_subscription_activity_carousel","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.9.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.9.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.10":{"name":"disable_go_social","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.10.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.10.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.11":{"name":"disable_gosocial_followers_that_you_follow","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.11.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.11.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.12":{"name":"disable_ios_resume_reading_toast","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.12.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.12.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.13":{"name":"disable_ios_subscription_activity_carousel","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.13.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.13.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.14":{"name":"disable_mobile_featured_chunk","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.14.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.14.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.15":{"name":"disable_post_recommended_from_friends_provider","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.15.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.15.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.16":{"name":"enable_android_local_currency","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.16.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.16.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.17":{"name":"enable_annual_renewal_reminder_email","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.17.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.17.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.18":{"name":"enable_app_flirty_thirty","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.18.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.18.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.19":{"name":"enable_auto_tier","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.19.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.19.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.20":{"name":"enable_automated_mission_control_triggers","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.20.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.20.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.21":{"name":"enable_branch_io","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.21.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.21.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.22":{"name":"enable_branding","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.22.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.22.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.23":{"name":"enable_branding_fonts","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.23.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.23.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.24":{"name":"enable_dedicated_series_tab_api_ios","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.24.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.24.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.25":{"name":"enable_different_grid","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.25.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.25.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.26":{"name":"enable_disregard_trunc_state_for_footer","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.26.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.26.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.27":{"name":"enable_edit_alt_text","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.27.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.27.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.28":{"name":"enable_email_sign_in_captcha","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.28.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.28.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.29":{"name":"enable_embedding_based_diversification","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.29.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.29.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.30":{"name":"enable_expanded_feature_chunk_pool","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.30.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.30.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.31":{"name":"enable_filter_by_resend_rules","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.31.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.31.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.32":{"name":"enable_first_name_on_paywall","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.32.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.32.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.33":{"name":"enable_geolocation_stripe_standard","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.33.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.33.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.34":{"name":"enable_google_one_tap","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.34.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.34.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.35":{"name":"enable_ios_post_stats","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.35.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.35.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.36":{"name":"enable_janky_spam_rules","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.36.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.36.valueType":{"__typename":"VariantFlagString","value":"users,posts"},"ROOT_QUERY.variantFlags.37":{"name":"enable_json_logs_trained_ranker","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.37.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.37.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.38":{"name":"enable_kafka_events","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.38.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.38.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.39":{"name":"enable_kbfd_rex","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.39.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.39.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.40":{"name":"enable_kbfd_rex_app_highlights","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.40.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.40.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.41":{"name":"enable_kbfd_rex_daily_digest","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.41.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.41.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.42":{"name":"enable_lite_notifications","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.42.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.42.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.43":{"name":"enable_lite_post","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.43.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.43.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.44":{"name":"enable_lite_post_cd","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.44.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.44.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.45":{"name":"enable_lite_post_highlights","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.45.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.45.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.46":{"name":"enable_lite_post_highlights_view_only","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.46.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.46.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.47":{"name":"enable_lite_profile","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.47.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.47.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.48":{"name":"enable_lite_pub_header_menu","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.48.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.48.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.49":{"name":"enable_lite_server_upstream_deadlines","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.49.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.49.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.50":{"name":"enable_lite_stories","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.50.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.50.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.51":{"name":"enable_lite_topics","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.51.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.51.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.52":{"name":"enable_lite_unread_notification_count_mutation","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.52.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.52.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.53":{"name":"enable_lo_homepage","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.53.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.53.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.54":{"name":"enable_lo_meter_swap","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.54.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.54.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.55":{"name":"enable_logged_out_homepage_signup","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.55.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.55.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.56":{"name":"enable_marketing_emails","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.56.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.56.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.57":{"name":"enable_media_resource_try_catch","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.57.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.57.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.58":{"name":"enable_membership_remove_section_a","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.58.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.58.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.59":{"name":"enable_membership_thank_you_email","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.59.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.59.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.60":{"name":"enable_more_branch_data","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.60.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.60.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.61":{"name":"enable_new_collaborative_filtering_data","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.61.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.61.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.62":{"name":"enable_new_pub_modules","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.62.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.62.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.63":{"name":"enable_new_suspended_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.63.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.63.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.64":{"name":"enable_new_three_dot_menu","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.64.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.64.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.65":{"name":"enable_optimizely","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.65.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.65.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.66":{"name":"enable_parsely","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.66.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.66.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.67":{"name":"enable_patronus_on_kubernetes","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.67.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.67.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.68":{"name":"enable_popularity_feature","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.68.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.68.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.69":{"name":"enable_post_import","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.69.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.69.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.70":{"name":"enable_post_seo_settings_screen","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.70.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.70.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.71":{"name":"enable_post_settings_screen","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.71.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.71.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.72":{"name":"enable_primary_topic_for_mobile","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.72.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.72.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.73":{"name":"enable_rito_caching","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.73.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.73.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.74":{"name":"enable_rito_upstream_deadlines","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.74.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.74.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.75":{"name":"enable_rtr_channel","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.75.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.75.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.76":{"name":"enable_save_to_medium","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.76.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.76.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.77":{"name":"enable_sign_up_with_email","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.77.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.77.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.78":{"name":"enable_suggest_account","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.78.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.78.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.79":{"name":"enable_suggest_account_li","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.79.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.79.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.80":{"name":"enable_tick_landing_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.80.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.80.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.81":{"name":"enable_tipalti_onboarding","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.81.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.81.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.82":{"name":"enable_topic_lifecycle_email","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.82.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.82.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.83":{"name":"enable_tribute_landing_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.83.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.83.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.84":{"name":"enable_trumpland_landing_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.84.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.84.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.85":{"name":"glyph_font_set","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.85.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.85.valueType":{"__typename":"VariantFlagString","value":"m2"},"ROOT_QUERY.variantFlags.86":{"name":"google_sign_in_android","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.86.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.86.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.87":{"name":"is_not_medium_subscriber","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.87.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.87.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.88":{"name":"new_transition_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.88.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.88.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.89":{"name":"pub_sidebar","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.89.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.89.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.90":{"name":"rank_model","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.90.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.90.valueType":{"__typename":"VariantFlagString","value":"default"},"ROOT_QUERY.variantFlags.91":{"name":"redis_read_write_splitting","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.91.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.91.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.92":{"name":"signin_services","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.92.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.92.valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"},"ROOT_QUERY.variantFlags.93":{"name":"signup_services","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.93.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.93.valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"},"ROOT_QUERY.variantFlags.94":{"name":"use_new_admin_topic_backend","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.94.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.94.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY":{"variantFlags":[{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.0","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.1","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.2","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.3","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.4","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.5","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.6","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.7","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.8","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.9","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.10","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.11","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.12","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.13","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.14","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.15","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.16","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.17","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.18","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.19","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.20","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.21","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.22","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.23","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.24","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.25","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.26","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.27","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.28","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.29","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.30","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.31","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.32","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.33","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.34","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.35","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.36","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.37","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.38","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.39","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.40","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.41","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.42","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.43","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.44","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.45","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.46","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.47","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.48","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.49","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.50","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.51","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.52","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.53","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.54","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.55","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.56","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.57","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.58","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.59","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.60","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.61","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.62","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.63","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.64","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.65","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.66","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.67","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.68","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.69","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.70","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.71","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.72","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.73","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.74","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.75","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.76","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.77","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.78","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.79","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.80","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.81","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.82","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.83","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.84","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.85","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.86","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.87","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.88","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.89","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.90","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.91","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.92","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.93","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.94","typename":"VariantFlag"}],"viewer":null,"meterPost({\"postId\":\"36c619df7945\",\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}})":{"type":"id","generated":false,"id":"MeteringInfo:singleton","typename":"MeteringInfo"},"postResult({\"id\":\"36c619df7945\"})":{"type":"id","generated":false,"id":"Post:36c619df7945","typename":"Post"}},"MeteringInfo:singleton":{"__typename":"MeteringInfo","postIds":{"type":"json","json":[]},"maxUnlockCount":3,"unlocksRemaining":3},"Post:36c619df7945":{"__typename":"Post","visibility":"PUBLIC","latestPublishedVersion":"338d39016dcc","collection":null,"id":"36c619df7945","creator":{"type":"id","generated":false,"id":"User:ffd0845cfbee","typename":"User"},"isLocked":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","sequence":null,"mediumUrl":"https:\u002F\u002Fmedium.com\u002F@lerner98\u002Fimplementing-sift-in-python-36c619df7945","canonicalUrl":"","content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}})":{"type":"id","generated":true,"id":"$Post:36c619df7945.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}})","typename":"PostContent"},"firstPublishedAt":1545871756529,"isPublished":true,"layerCake":4,"primaryTopic":null,"title":"Implementing SIFT in Python","isLimitedState":false,"pendingCollection":null,"shareKey":null,"statusForCollection":null,"readingTime":15.008490566037736,"readingList":"READING_LIST_NONE","license":"ALL_RIGHTS_RESERVED","allowResponses":true,"tags":[{"type":"id","generated":false,"id":"Tag:computer-vision","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:sift","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:python","typename":"Tag"}],"viewerClapCount":0,"clapCount":230,"voterCount":28,"recommenders":[],"responsesCount":1,"collaborators":[],"translationSourcePost":null,"newsletterId":"","inResponseToPostResult":null,"inResponseToMediaResource":null,"curationEligibleAt":0,"isDistributionAlertDismissed":false,"audioVersionUrl":"","seoTitle":"","socialTitle":"","socialDek":"","metaDescription":"","latestPublishedAt":1545940963639,"previewContent":{"type":"id","generated":true,"id":"$Post:36c619df7945.previewContent","typename":"PreviewContent"},"previewImage":{"type":"id","generated":false,"id":"ImageMetadata:1*vzUvEVlZWbfCDBO44fIdcw.png","typename":"ImageMetadata"},"updatedAt":1545940963639,"topics":[],"seoDescription":"","isSuspended":false},"User:ffd0845cfbee":{"id":"ffd0845cfbee","__typename":"User","isSuspended":false,"allowNotes":true,"name":"Sam Lerner","isFollowing":false,"username":"lerner98","bio":"Computer science enthusiast","imageId":"1*IE48KfS1qALgA-1G_tvGpQ.png","mediumMemberAt":0,"isBlocking":false,"isPartnerProgramEnrolled":false,"twitterScreenName":""},"$Post:36c619df7945.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}})":{"isLockedPreviewOnly":false,"validatedShareKey":"","__typename":"PostContent","bodyModel":{"type":"id","generated":true,"id":"$Post:36c619df7945.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel","typename":"RichText"}},"$Post:36c619df7945.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.sections.0":{"name":"a5e4","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:36c619df7945.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.sections.1":{"name":"4cf4","startIndex":2,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:36c619df7945.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.sections.2":{"name":"acc6","startIndex":7,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:36c619df7945.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.sections.3":{"name":"f182","startIndex":13,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:36c619df7945.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.sections.4":{"name":"8c39","startIndex":64,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:36c619df7945.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.sections.5":{"name":"4b95","startIndex":108,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:36c619df7945.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.sections.6":{"name":"1620","startIndex":169,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:36c619df7945.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.sections.7":{"name":"f1f2","startIndex":177,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:36c619df7945.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel":{"sections":[{"type":"id","generated":true,"id":"$Post:36c619df7945.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.sections.0","typename":"Section"},{"type":"id","generated":true,"id":"$Post:36c619df7945.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.sections.1","typename":"Section"},{"type":"id","generated":true,"id":"$Post:36c619df7945.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.sections.2","typename":"Section"},{"type":"id","generated":true,"id":"$Post:36c619df7945.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.sections.3","typename":"Section"},{"type":"id","generated":true,"id":"$Post:36c619df7945.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.sections.4","typename":"Section"},{"type":"id","generated":true,"id":"$Post:36c619df7945.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.sections.5","typename":"Section"},{"type":"id","generated":true,"id":"$Post:36c619df7945.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.sections.6","typename":"Section"},{"type":"id","generated":true,"id":"$Post:36c619df7945.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.sections.7","typename":"Section"}],"paragraphs":[{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_0","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_1","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_2","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_3","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_4","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_5","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_6","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_7","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_8","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_9","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_10","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_11","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_12","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_13","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_14","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_15","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_16","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_17","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_18","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_19","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_20","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_21","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_22","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_23","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_24","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_25","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_26","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_27","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_28","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_29","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_30","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_31","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_32","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_33","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_34","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_35","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_36","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_37","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_38","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_39","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_40","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_41","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_42","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_43","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_44","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_45","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_46","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_47","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_48","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_49","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_50","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_51","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_52","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_53","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_54","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_55","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_56","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_57","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_58","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_59","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_60","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_61","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_62","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_63","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_64","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_65","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_66","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_67","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_68","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_69","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_70","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_71","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_72","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_73","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_74","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_75","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_76","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_77","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_78","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_79","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_80","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_81","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_82","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_83","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_84","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_85","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_86","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_87","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_88","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_89","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_90","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_91","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_92","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_93","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_94","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_95","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_96","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_97","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_98","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_99","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_100","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_101","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_102","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_103","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_104","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_105","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_106","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_107","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_108","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_109","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_110","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_111","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_112","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_113","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_114","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_115","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_116","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_117","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_118","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_119","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_120","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_121","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_122","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_123","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_124","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_125","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_126","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_127","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_128","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_129","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_130","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_131","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_132","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_133","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_134","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_135","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_136","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_137","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_138","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_139","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_140","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_141","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_142","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_143","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_144","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_145","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_146","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_147","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_148","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_149","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_150","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_151","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_152","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_153","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_154","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_155","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_156","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_157","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_158","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_159","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_160","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_161","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_162","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_163","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_164","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_165","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_166","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_167","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_168","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_169","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_170","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_171","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_172","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_173","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_174","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_175","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_176","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_177","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_178","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_179","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:338d39016dcc_180","typename":"Paragraph"}],"__typename":"RichText"},"Paragraph:338d39016dcc_0":{"id":"338d39016dcc_0","name":"9a7f","type":"H3","href":null,"layout":null,"metadata":null,"text":"Implementing SIFT in Python","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_1":{"id":"338d39016dcc_1","name":"cba6","type":"P","href":null,"layout":null,"metadata":null,"text":"There’s a lot of content about SIFT online. There are a lot of good tutorials, but each seemed to be lacking something, whether that be details about the algorithm or the implementation. So when I decided I wanted to implement SIFT for myself, I found myself struggling to pull content from many, sometimes conflicting, sources. I have finally completed the task and have decided to share my process as well as some of the details other tutorials fail to mention.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_2":{"id":"338d39016dcc_2","name":"a1e2","type":"H3","href":null,"layout":null,"metadata":null,"text":"Introduction","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_3":{"id":"338d39016dcc_3","name":"79bf","type":"P","href":null,"layout":null,"metadata":null,"text":"For starters, what even is SIFT? SIFT, which stands for Scale Invariant Feature Transform, is a method for extracting feature vectors that describe local patches of an image. Not only are these feature vectors scale-invariant, but they are also invariant to translation, rotation, and illumination. Pretty much the holy grail for a descriptor.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_4":{"id":"338d39016dcc_4","name":"b64e","type":"P","href":null,"layout":null,"metadata":null,"text":"These descriptors are useful for matching objects are patches between images. For example, consider creating a panorama. Assuming each image has some overlapping parts, you need some way to align them so we can stitch them together. If we have some points in each image that we know correspond, we can warp one of the images using a homography. SIFT helps with automatically finding not only corresponding points in each image, but points that are easy to match.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_5":{"id":"338d39016dcc_5","name":"1211","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*pwOhfFcv28p90fgwWhBzzw.png","typename":"ImageMetadata"},"text":"Two images with an overlapping region","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*pwOhfFcv28p90fgwWhBzzw.png":{"id":"1*pwOhfFcv28p90fgwWhBzzw.png","originalHeight":418,"originalWidth":1224,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:338d39016dcc_6":{"id":"338d39016dcc_6","name":"a3c5","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*5LTZZiJIGUNnPXr_EGm_nQ.png","typename":"ImageMetadata"},"text":"Result after transforming one image using the homography from SIFT feature points","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*5LTZZiJIGUNnPXr_EGm_nQ.png":{"id":"1*5LTZZiJIGUNnPXr_EGm_nQ.png","originalHeight":670,"originalWidth":1336,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:338d39016dcc_7":{"id":"338d39016dcc_7","name":"6915","type":"H3","href":null,"layout":null,"metadata":null,"text":"Description of the Algorithm","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_8":{"id":"338d39016dcc_8","name":"b20c","type":"P","href":null,"layout":null,"metadata":null,"text":"As described on Wikipedia: https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FScale-invariant_feature_transform, the SIFT algorithm has four main steps:","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:338d39016dcc_8.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_8.markups.0":{"type":"A","start":27,"end":90,"href":"http:\u002F\u002FWikipedia","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:338d39016dcc_9":{"id":"338d39016dcc_9","name":"c446","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Scale-Space Extrema Detection","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_10":{"id":"338d39016dcc_10","name":"f8de","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Keypoint Localization","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_11":{"id":"338d39016dcc_11","name":"52a0","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Orientation Assignment","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_12":{"id":"338d39016dcc_12","name":"4da9","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Local Descriptor Creation","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_13":{"id":"338d39016dcc_13","name":"95e3","type":"H3","href":null,"layout":null,"metadata":null,"text":"Scale-Space Extrema Detection","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_14":{"id":"338d39016dcc_14","name":"b1e9","type":"P","href":null,"layout":null,"metadata":null,"text":"The characteristic scale of a feature can be detected using a scale-normalized Laplacian-of-Gaussian (LoG) filter. This is what the LoG filter looks like:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_15":{"id":"338d39016dcc_15","name":"e462","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*nBfErR8RyTc05d82owhDWw.png","typename":"ImageMetadata"},"text":"Negative LoG","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*nBfErR8RyTc05d82owhDWw.png":{"id":"1*nBfErR8RyTc05d82owhDWw.png","originalHeight":936,"originalWidth":1696,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:338d39016dcc_16":{"id":"338d39016dcc_16","name":"6926","type":"P","href":null,"layout":null,"metadata":null,"text":"The LoG filter is highly peaked at the center while becoming slightly negative and then zero at a distance from the center characterized by the standard deviation, sigma, of the Gaussian.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_17":{"id":"338d39016dcc_17","name":"b6f7","type":"P","href":null,"layout":null,"metadata":null,"text":"Therefore, the LoG filter is most highly activated by a circle, or blob, with radius proportional to sigma. However, the Gaussian is normalized, i.e. if you integrate it over all space it sums to one. Therefore, with a higher sigma and therefore a wider Gaussian, the response of the LoG filter for that Gaussian will be lower than for a smaller sigma. Therefore, SIFT uses the scale-normalized LoG filter which is the regular LoG multiplied by the variance (sigma squared).","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:338d39016dcc_17.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_17.markups.0":{"type":"STRONG","start":378,"end":394,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:338d39016dcc_18":{"id":"338d39016dcc_18","name":"f8b5","type":"H4","href":null,"layout":null,"metadata":null,"text":"DoG Approximation","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_19":{"id":"338d39016dcc_19","name":"1375","type":"P","href":null,"layout":null,"metadata":null,"text":"While the scale-normalized LoG is fine and dandy, it is expensive to compute, especially since we need to calculate it at many different scales. Thankfully, the authors of SIFT came up with a clever way to efficiently calculate the LoG at many scales.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_20":{"id":"338d39016dcc_20","name":"b722","type":"P","href":null,"layout":null,"metadata":null,"text":"It turns out that the difference of two Gaussians with similar variance yields a filter that approximates the scale-normalized LoG very well:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_21":{"id":"338d39016dcc_21","name":"39bb","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*jFQVYG7VrXs44V0Qbr1GUQ.gif","typename":"ImageMetadata"},"text":"The difference of two Gaussians approximates the Laplacian of a Gaussian","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*jFQVYG7VrXs44V0Qbr1GUQ.gif":{"id":"1*jFQVYG7VrXs44V0Qbr1GUQ.gif","originalHeight":447,"originalWidth":625,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:338d39016dcc_22":{"id":"338d39016dcc_22","name":"9a92","type":"H4","href":null,"layout":null,"metadata":null,"text":"DoG Pyramid","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_23":{"id":"338d39016dcc_23","name":"430f","type":"P","href":null,"layout":null,"metadata":null,"text":"Now that we have an efficient way to approximate the LoG, we need to compute it at multiple scales. SIFT uses a number of octaves to calculate the DoG. Most people would think that an octave means that eight images are computed. However, an octave is actually a set of images were the blur of the last image is double the blur of the first image.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:338d39016dcc_23.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:338d39016dcc_23.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_23.markups.0":{"type":"STRONG","start":311,"end":317,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:338d39016dcc_23.markups.1":{"type":"EM","start":122,"end":129,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:338d39016dcc_24":{"id":"338d39016dcc_24","name":"eea4","type":"P","href":null,"layout":null,"metadata":null,"text":"To create this octave, we first need to choose the number of images we want in each octave. This is denoted by s. Then the sigma for the Gaussian filter is chosen to be 2^(1\u002Fs). Since blur accumulates multiplicatively, when we blur the original image with this filter s times, the result will have blur = 2 * original blur.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_25":{"id":"338d39016dcc_25","name":"ddb3","type":"P","href":null,"layout":null,"metadata":null,"text":"One detail from the paper that I rarely see mentioned is that in each octave, you actually need to produce s+3 images (including the original image). This is because when adjacent levels are subtracted to obtain the approximated LoG octave, we will get one less image than in the Gaussian octave:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_26":{"id":"338d39016dcc_26","name":"d976","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*vzUvEVlZWbfCDBO44fIdcw.png","typename":"ImageMetadata"},"text":"DoG pyramid used for SIFT","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*vzUvEVlZWbfCDBO44fIdcw.png":{"id":"1*vzUvEVlZWbfCDBO44fIdcw.png","originalHeight":880,"originalWidth":1206,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:338d39016dcc_27":{"id":"338d39016dcc_27","name":"19df","type":"P","href":null,"layout":null,"metadata":null,"text":"Now we have s+2 images in the DoG octave. However, later when we look for extrema in the DoG, we will look for the min or max of a neighborhood specified by the current and adjacent levels. Obviously, this neighborhood cannot be obtained at the top or bottom level, so we have these two extra levels so that the neighborhood is defined over a full octave in the scale space. This will be more clear in the next section.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_28":{"id":"338d39016dcc_28","name":"fc46","type":"P","href":null,"layout":null,"metadata":null,"text":"After we have generated the Gaussian octave, we downsample the top level by two and use that as the bottom level for a new octave. The original paper uses four octaves. These octaves make up what I call the Gaussian pyramid.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_29":{"id":"338d39016dcc_29","name":"d205","type":"H4","href":null,"layout":null,"metadata":null,"text":"Implementation","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_30":{"id":"338d39016dcc_30","name":"1a39","type":"P","href":null,"layout":null,"metadata":null,"text":"Finally we are getting to some code. First, we obviously need a Gaussian filter for creation of the Gaussian octave:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_31":{"id":"338d39016dcc_31","name":"dbb7","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def gaussian_filter(sigma): \n  size = 2*np.ceil(3*sigma)+1 \n  x, y = np.mgrid[-size\u002F\u002F2 + 1:size\u002F\u002F2 + 1, -size\u002F\u002F2 + 1:size\u002F\u002F2 + 1] \n  g = np.exp(-((x**2 + y**2)\u002F(2.0*sigma**2))) \u002F (2*np.pi*sigma**2)\n  return g\u002Fg.sum()","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_32":{"id":"338d39016dcc_32","name":"7c75","type":"P","href":null,"layout":null,"metadata":null,"text":"This assumes that numpy is already imported as np (as it always should be). I also put it in a file called gaussian_filter.py. Next, to generate a Gaussian octave, we simply need to select sigma (or k as it is called in the paper) and repeatedly convolve with this Gaussian filter:","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:338d39016dcc_32.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_32.markups.0":{"type":"CODE","start":107,"end":125,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:338d39016dcc_33":{"id":"338d39016dcc_33","name":"6ff6","type":"PRE","href":null,"layout":null,"metadata":null,"text":"from scipy.ndimage.filters import convolve \nfrom gaussian_filter import gaussian_filter ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_34":{"id":"338d39016dcc_34","name":"3ca6","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def generate_octave(init_level, s, sigma): \n  octave = [init_level] \n  k = 2**(1\u002Fs) \n  kernel = gaussian_filter(k * sigma) ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_35":{"id":"338d39016dcc_35","name":"d5a9","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  for _in range(s+2): \n    next_level = convolve(octave[-1], kernel) \n    octave.append(next_level) ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_36":{"id":"338d39016dcc_36","name":"c84c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  return octave","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_37":{"id":"338d39016dcc_37","name":"41ea","type":"P","href":null,"layout":null,"metadata":null,"text":"Just as in the paper, I use an s of 5. One other thing to note is sigma parameter. This parameter is used to scale k so that the blur in each DoG octave goes from sigma -\u003E 2*sigma. I use a value of 1.6 for sigma. Then to generate the whole Gaussian pyramid:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_38":{"id":"338d39016dcc_38","name":"50de","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def generate_gaussian_pyramid(im, num_octave, s, sigma): \n  pyr = [] ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_39":{"id":"338d39016dcc_39","name":"9e07","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  for _ in range(num_octave): \n    octave = generate_octave(im, s, sigma) \n    pyr.append(octave) \n    im = octave[-3][::2, ::2] ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_40":{"id":"338d39016dcc_40","name":"86d3","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  return pyr","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_41":{"id":"338d39016dcc_41","name":"5b28","type":"P","href":null,"layout":null,"metadata":null,"text":"Since we generate s+3 images per octave, we use the third to last image as the base for the next octave since that is the one with a blur of 2*sigma.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_42":{"id":"338d39016dcc_42","name":"1653","type":"P","href":null,"layout":null,"metadata":null,"text":"Now that we have the Gaussian pyramid, it is trivial to create the DoG pyramid:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_43":{"id":"338d39016dcc_43","name":"cddb","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def generate_DoG_octave(gaussian_octave): \n  octave = [] ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_44":{"id":"338d39016dcc_44","name":"bab9","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  for i in range(1, len(gaussian_octave)):   \n    octave.append(gaussian_octave[i] — gaussian_octave[i-1]) ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_45":{"id":"338d39016dcc_45","name":"edfc","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  return np.concatenate([o[:,:,np.newaxis] for o in octave], axis=2) ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_46":{"id":"338d39016dcc_46","name":"39c9","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def generate_DoG_pyramid(gaussian_pyramid): \n  pyr = [] ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_47":{"id":"338d39016dcc_47","name":"c133","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  for gaussian_octave in gaussian_pyramid: \n    pyr.append(generate_DoG_octave(gaussian_octave)) ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_48":{"id":"338d39016dcc_48","name":"2551","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  return pyr","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_49":{"id":"338d39016dcc_49","name":"8004","type":"P","href":null,"layout":null,"metadata":null,"text":"Now we have four DoG octaves, each with s+2 levels of blur. We can now move on to detecting extrema in the scale space.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_50":{"id":"338d39016dcc_50","name":"c736","type":"H4","href":null,"layout":null,"metadata":null,"text":"Extrema Detection","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_51":{"id":"338d39016dcc_51","name":"8cae","type":"P","href":null,"layout":null,"metadata":null,"text":"The first step in extrema detection is to scan over each scale-space DoG octave, D, and include the center of each 3x3x3 neighborhood as a keypoint if it is the minimum or maximum value in neighborhood.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_52":{"id":"338d39016dcc_52","name":"bc62","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*kwBQSL5U-QGSLd-ovlAHFw.png","typename":"ImageMetadata"},"text":"Neighborhood for the initial scale-space extrema detection","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*kwBQSL5U-QGSLd-ovlAHFw.png":{"id":"1*kwBQSL5U-QGSLd-ovlAHFw.png","originalHeight":420,"originalWidth":468,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:338d39016dcc_53":{"id":"338d39016dcc_53","name":"5ff4","type":"P","href":null,"layout":null,"metadata":null,"text":"This is why we generated s+2 levels in the DoG octave, since we cannot scan over the points in the top or bottom level, but we still want to get keypoints over a full octave of blur.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_54":{"id":"338d39016dcc_54","name":"cec6","type":"H4","href":null,"layout":null,"metadata":null,"text":"Implementation","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_55":{"id":"338d39016dcc_55","name":"9a69","type":"P","href":null,"layout":null,"metadata":null,"text":"Given a DoG octave, we obtain the initial candidate keypoints with:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_56":{"id":"338d39016dcc_56","name":"fac8","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def get_candidate_keypoints(D, w=16): \n  candidates = [] \n  D[:,:,0] = 0 \n  D[:,:,-1] = 0 ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_57":{"id":"338d39016dcc_57","name":"b767","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  for i in range(w\u002F\u002F2+1, D.shape[0]-w\u002F\u002F2–1): \n    for j in range(w\u002F\u002F2+1, D.shape[1]-w\u002F\u002F2–1): \n      for k in range(1, D.shape[2]-1): \n        patch = D[i-1:i+2, j-1:j+2, k-1:k+2] \n        if np.argmax(patch) == 13 or np.argmin(patch) == 13: \n          candidates.append([i, j, k]) ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_58":{"id":"338d39016dcc_58","name":"7a6c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  return candidates","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_59":{"id":"338d39016dcc_59","name":"7d56","type":"P","href":null,"layout":null,"metadata":null,"text":"I have a few things to say about this code:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_60":{"id":"338d39016dcc_60","name":"2f72","type":"OLI","href":null,"layout":null,"metadata":null,"text":"I set the top and bottom extra levels to 0 because I was initially only getting extrema in those levels. This is probably due an incorrect construction of the DoG octave, but it seems to work well enough.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_61":{"id":"338d39016dcc_61","name":"cf8b","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Instead of scanning with a padding of one on each level, we have a padding of w\u002F2 where w is the side length for the patches used when creating local descriptors. Without this, I was getting out of bounds errors.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_62":{"id":"338d39016dcc_62","name":"9b58","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Calling argmax or argmin without an axis parameter runs on the flattened array. Since our neighborhood is 3x3x3, or 27 elements long, when the extrema is our inspected pixel, the value of argmax or argmin will be 13.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:338d39016dcc_62.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:338d39016dcc_62.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_62.markups.0":{"type":"CODE","start":8,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:338d39016dcc_62.markups.1":{"type":"CODE","start":18,"end":24,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:338d39016dcc_63":{"id":"338d39016dcc_63","name":"91f3","type":"P","href":null,"layout":null,"metadata":null,"text":"These candidate keypoints yield many poor choices and\u002For noisy, so in the next section we will throw out bad ones as well refine good ones.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_64":{"id":"338d39016dcc_64","name":"7b4b","type":"H3","href":null,"layout":null,"metadata":null,"text":"Keypoint Localization","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_65":{"id":"338d39016dcc_65","name":"5cc3","type":"P","href":null,"layout":null,"metadata":null,"text":"We will perform three steps to get better keypoints:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_66":{"id":"338d39016dcc_66","name":"33cc","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Compute the subpixel location of each keypoint","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_67":{"id":"338d39016dcc_67","name":"f662","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Throw out that keypoint if it’s scale-space value at the subpixel is below a threshold","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_68":{"id":"338d39016dcc_68","name":"1adf","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Eliminate keypoints on edges using the Hessian around each subpixel keypoint","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_69":{"id":"338d39016dcc_69","name":"6ed7","type":"H4","href":null,"layout":null,"metadata":null,"text":"Subpixel Localization","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_70":{"id":"338d39016dcc_70","name":"b358","type":"P","href":null,"layout":null,"metadata":null,"text":"In many images, the resolution is not fine enough to find stable keypoints, i.e. in the same location in multiple images under multiple conditions. Therefore, the creators of SIFT use the second-order Taylor expansion of the DoG octave to further localize each keypoint.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_71":{"id":"338d39016dcc_71","name":"d113","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*vKFAMxBpUc5EMpPJ4wBPxg.png","typename":"ImageMetadata"},"text":"Second-order Taylor expansion of the DoG octave","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*vKFAMxBpUc5EMpPJ4wBPxg.png":{"id":"1*vKFAMxBpUc5EMpPJ4wBPxg.png","originalHeight":106,"originalWidth":496,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:338d39016dcc_72":{"id":"338d39016dcc_72","name":"4fc2","type":"P","href":null,"layout":null,"metadata":null,"text":"Here, x is the three-dimensional vector [x, y, sigma] corresponding to the pixel location of the candidate keypoint. Taking the derivative of this equation with respect to x and setting it equal to zero yields the subpixel offset for the keypoint:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_73":{"id":"338d39016dcc_73","name":"55fd","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*y2yhBZyDyAcEesR9t0htKA.png","typename":"ImageMetadata"},"text":"Candidate keypoint offset (second-order)","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*y2yhBZyDyAcEesR9t0htKA.png":{"id":"1*y2yhBZyDyAcEesR9t0htKA.png","originalHeight":126,"originalWidth":272,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:338d39016dcc_74":{"id":"338d39016dcc_74","name":"2ddd","type":"P","href":null,"layout":null,"metadata":null,"text":"This offset is added to the original keypoint location to achieve subpixel accuracy.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_75":{"id":"338d39016dcc_75","name":"94db","type":"P","href":null,"layout":null,"metadata":null,"text":"If you uncomfortable with this math, I would suggest reading the paper or some other sources on Taylor expansions because this post is already becoming a behemoth.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_76":{"id":"338d39016dcc_76","name":"adac","type":"H4","href":null,"layout":null,"metadata":null,"text":"Implementation","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_77":{"id":"338d39016dcc_77","name":"8ab2","type":"P","href":null,"layout":null,"metadata":null,"text":"We need to compute both the Jacobian and Hessian around each candidate keypoint in order to get the offset:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_78":{"id":"338d39016dcc_78","name":"746c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def localize_keypoint(D, x, y, s): \n  dx = (D[y,x+1,s]-D[y,x-1,s])\u002F2. \n  dy = (D[y+1,x,s]-D[y-1,x,s])\u002F2. \n  ds = (D[y,x,s+1]-D[y,x,s-1])\u002F2. ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_79":{"id":"338d39016dcc_79","name":"5a10","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  dxx = D[y,x+1,s]-2*D[y,x,s]+D[y,x-1,s] \n  dxy = ((D[y+1,x+1,s]-D[y+1,x-1,s]) — (D[y-1,x+1,s]-D[y-1,x-1,s]))\u002F4. \n  dxs = ((D[y,x+1,s+1]-D[y,x-1,s+1]) — (D[y,x+1,s-1]-D[y,x-1,s-1]))\u002F4. \n  dyy = D[y+1,x,s]-2*D[y,x,s]+D[y-1,x,s] \n  dys = ((D[y+1,x,s+1]-D[y-1,x,s+1]) — (D[y+1,x,s-1]-D[y-1,x,s-1]))\u002F4. \n  dss = D[y,x,s+1]-2*D[y,x,s]+D[y,x,s-1] ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_80":{"id":"338d39016dcc_80","name":"41b8","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  J = np.array([dx, dy, ds]) \n  HD = np.array([ [dxx, dxy, dxs], [dxy, dyy, dys], [dxs, dys, dss]]) ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_81":{"id":"338d39016dcc_81","name":"fdcf","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  offset = -LA.inv(HD).dot(J)\n  return offset, J, HD[:2,:2], x, y, s","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_82":{"id":"338d39016dcc_82","name":"a820","type":"P","href":null,"layout":null,"metadata":null,"text":"First, the first derivatives are computed for the Jacobian. Then, we compute the second derivatives for the Hessian. Thankfully, the Hessian is symmetric, so we only have to calculate six derivatives instead of nine. We return J and H because we will need them later.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_83":{"id":"338d39016dcc_83","name":"3d77","type":"P","href":null,"layout":null,"metadata":null,"text":"As a side note, when a dimension of the offset is greater than 0.5, that means it is actually closer to another pixel-level keypoint. The paper says to redo this process with the candidate keypoint closer to the offset but I couldn’t get it to work.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_84":{"id":"338d39016dcc_84","name":"3756","type":"P","href":null,"layout":null,"metadata":null,"text":"Again, if you’re uncomfortable with multivariable calculus or don’t really understand what I’m saying, I suggest you read up on it before continuing.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_85":{"id":"338d39016dcc_85","name":"a046","type":"H4","href":null,"layout":null,"metadata":null,"text":"Discarding Low-Contrast Keypoints","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_86":{"id":"338d39016dcc_86","name":"2f65","type":"P","href":null,"layout":null,"metadata":null,"text":"The contrast for each subpixel keypoint can now be computed as:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_87":{"id":"338d39016dcc_87","name":"c201","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*2906rv2nl7qFTyWWqun9gA.png","typename":"ImageMetadata"},"text":"Subpixel keypoint contrast","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*2906rv2nl7qFTyWWqun9gA.png":{"id":"1*2906rv2nl7qFTyWWqun9gA.png","originalHeight":108,"originalWidth":340,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:338d39016dcc_88":{"id":"338d39016dcc_88","name":"b45d","type":"P","href":null,"layout":null,"metadata":null,"text":"Which is the subpixel offset added to the pixel-level location. If the absolute value is below a threshold, we throw the point out. We do this because we want extrema that are, well, extreme.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_89":{"id":"338d39016dcc_89","name":"0c48","type":"H4","href":null,"layout":null,"metadata":null,"text":"Eliminating Edge Responses","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_90":{"id":"338d39016dcc_90","name":"94bc","type":"P","href":null,"layout":null,"metadata":null,"text":"The scale-normalized LoG will create high-contrast responses on both corners as well as edges. However, keypoints on edges should be discarded because their orientation is ambiguous. To do this, we use the Hessian calculated when computing the subpixel offset. This process is very similar to finding corners using a Harris corner detector.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_91":{"id":"338d39016dcc_91","name":"e8fe","type":"P","href":null,"layout":null,"metadata":null,"text":"The Hessian that we return from localize_keypoint is of the form:","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:338d39016dcc_91.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_91.markups.0":{"type":"CODE","start":32,"end":49,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:338d39016dcc_92":{"id":"338d39016dcc_92","name":"5336","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*bgkZDxW9KCST_Q9OjQ5OnQ.png","typename":"ImageMetadata"},"text":"The Hessian in scale space. Proportional to curvature","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*bgkZDxW9KCST_Q9OjQ5OnQ.png":{"id":"1*bgkZDxW9KCST_Q9OjQ5OnQ.png","originalHeight":132,"originalWidth":292,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:338d39016dcc_93":{"id":"338d39016dcc_93","name":"76a3","type":"P","href":null,"layout":null,"metadata":null,"text":"If you are familiar with the Harris detector, if the eigenvalues of H (say A and B) are both large, then the keypoint is most likely a corner. Conversely, if one is substantially larger, then it is most likely an edge.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_94":{"id":"338d39016dcc_94","name":"fc7f","type":"P","href":null,"layout":null,"metadata":null,"text":"Even though it is inexpensive to calculate the eigenvalues for this matrix, there is another way to do it involving taking the trace and determinant of H. We will forgo that discussing here but it is in the original paper.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_95":{"id":"338d39016dcc_95","name":"9a2c","type":"H4","href":null,"layout":null,"metadata":null,"text":"Implementation","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_96":{"id":"338d39016dcc_96","name":"ba4e","type":"P","href":null,"layout":null,"metadata":null,"text":"We perform the aforementioned steps in the following function:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_97":{"id":"338d39016dcc_97","name":"f512","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def find_keypoints_for_DoG_octave(D, R_th, t_c, w): \n  candidates = get_candidate_keypoints(D, w)\n  keypoints = [] ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_98":{"id":"338d39016dcc_98","name":"2497","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  for i, cand in enumerate(candidates): \n    y, x, s = cand[0], cand[1], cand[2] \n    offset, J, H, x, y, s = localize_keypoint(D, x, y, s) ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_99":{"id":"338d39016dcc_99","name":"be08","type":"PRE","href":null,"layout":null,"metadata":null,"text":"    contrast = D[y,x,s] + .5*J.dot(offset) \n    if abs(contrast) \u003C t_c: continue ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_100":{"id":"338d39016dcc_100","name":"b285","type":"PRE","href":null,"layout":null,"metadata":null,"text":"    w, v = LA.eig(H) \n    r = w[1]\u002Fw[0] \n    R = (r+1)**2 \u002F r \n    if R \u003E R_th: continue ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_101":{"id":"338d39016dcc_101","name":"e5ff","type":"PRE","href":null,"layout":null,"metadata":null,"text":"    kp = np.array([x, y, s]) + offset\n    keypoints.append(kp)","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_102":{"id":"338d39016dcc_102","name":"1be2","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  return np.array(keypoints)","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_103":{"id":"338d39016dcc_103","name":"8040","type":"P","href":null,"layout":null,"metadata":null,"text":"I use the values from the paper for t_c and R_th, namely 0.03 and (10+1)²\u002F10 respectively. The motivation for R_th is more clear in the paper.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:338d39016dcc_103.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:338d39016dcc_103.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:338d39016dcc_103.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_103.markups.0":{"type":"CODE","start":36,"end":39,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:338d39016dcc_103.markups.1":{"type":"CODE","start":44,"end":48,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:338d39016dcc_103.markups.2":{"type":"CODE","start":110,"end":114,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:338d39016dcc_104":{"id":"338d39016dcc_104","name":"51d4","type":"P","href":null,"layout":null,"metadata":null,"text":"Now it is trivial to calculate the keypoints for the whole DoG pyramid:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_105":{"id":"338d39016dcc_105","name":"e12f","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def get_keypoints(DoG_pyr, R_th, t_c, w): \n  kps = [] ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_106":{"id":"338d39016dcc_106","name":"e212","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  for D in DoG_pyr: \n    kps.append(find_keypoints_for_DoG_octave(D, R_th, t_c, w)) ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_107":{"id":"338d39016dcc_107","name":"c3c1","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  return kps","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_108":{"id":"338d39016dcc_108","name":"d9b9","type":"H3","href":null,"layout":null,"metadata":null,"text":"Orientation Assignment","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_109":{"id":"338d39016dcc_109","name":"81e9","type":"P","href":null,"layout":null,"metadata":null,"text":"Getting the keypoints is only half the battle. Now we have to obtain the actual descriptors. But before we do so, we need to ensure another type of invariance: rotational.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_110":{"id":"338d39016dcc_110","name":"578a","type":"P","href":null,"layout":null,"metadata":null,"text":"We have translational invariance because we convolve our filters over the image. We also have scale invariance because of our use of the scale-normalized LoG filter. Now to impose rotational invariance, we assign the patch around each keypoint an orientation corresponding to its dominant gradient direction. This comes in handy later when we use the Histogram of Gradients descriptor to describe each patch.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_111":{"id":"338d39016dcc_111","name":"5300","type":"P","href":null,"layout":null,"metadata":null,"text":"To assign orientation, we take a patch around each keypoint thats size is proportional to the scale of that keypoint. We then create a histogram of the gradients for each pixel in that patch.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_112":{"id":"338d39016dcc_112","name":"9c46","type":"P","href":null,"layout":null,"metadata":null,"text":"The histogram is created on angle (the gradient is specified in polar coordinates) and has 36 bins (each bin has a width of 10 degrees). When the magnitude and angle of the gradient at a pixel is calculated, the corresponding bin in our histogram grows by the gradient magnitude weighted by the Gaussian window.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_113":{"id":"338d39016dcc_113","name":"1f9d","type":"P","href":null,"layout":null,"metadata":null,"text":"Once we have our histogram, we assign that keypoint the orientation of the maximal histogram bin.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_114":{"id":"338d39016dcc_114","name":"c3e8","type":"H4","href":null,"layout":null,"metadata":null,"text":"Implementation","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_115":{"id":"338d39016dcc_115","name":"9b1f","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def assign_orientation(kps, octave, num_bins=36): \n  new_kps = [] \n  bin_width = 360\u002F\u002Fnum_bins ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_116":{"id":"338d39016dcc_116","name":"5830","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  for kp in kps: \n    cx, cy, s = int(kp[0]), int(kp[1]), int(kp[2]) \n    s = np.clip(s, 0, octave.shape[2]-1) \n    sigma = kp[2]*1.5 \n    w = int(2*np.ceil(sigma)+1) \n    kernel = gaussian_filter(sigma) \n    L = octave[…,s]\n    hist = np.zeros(num_bins, dtype=np.float32) ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_117":{"id":"338d39016dcc_117","name":"8925","type":"PRE","href":null,"layout":null,"metadata":null,"text":"    for oy in range(-w, w+1): \n      for ox in range(-w, w+1): \n        x, y = cx+ox, cy+oy \n        if x \u003C 0 or x \u003E octave.shape[1]-1: continue \n        elif y \u003C 0 or y \u003E octave.shape[0]-1: continue ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_118":{"id":"338d39016dcc_118","name":"66ae","type":"PRE","href":null,"layout":null,"metadata":null,"text":"        m, theta = get_grad(L, x, y) \n        weight = kernel[oy+w, ox+w] * m \n        bin = quantize_orientation(theta, num_bins) \n        hist[bin] += weight ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_119":{"id":"338d39016dcc_119","name":"37f2","type":"PRE","href":null,"layout":null,"metadata":null,"text":"    max_bin = np.argmax(hist) \n    new_kps.append([kp[0], kp[1], kp[2], fit_parabola(hist, max_bin, bin_width)]) \n    max_val = np.max(hist) ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_120":{"id":"338d39016dcc_120","name":"f5a1","type":"PRE","href":null,"layout":null,"metadata":null,"text":"    for binno, val in enumerate(hist): \n      if binno == max_bin: continue \n      if .8 * max_val \u003C= val: \n        new_kps.append([kp[0], kp[1], kp[2], fit_parabola(hist, binno, bin_width)])","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_121":{"id":"338d39016dcc_121","name":"4a82","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  return np.array(new_kps)","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_122":{"id":"338d39016dcc_122","name":"ffe5","type":"P","href":null,"layout":null,"metadata":null,"text":"The one thing I want to mention about this function is the last loop. The paper specifies that for any histogram bin that has a value within 80% of the maximum value to create a new keypoint at that location and scale but with the new orientation.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_123":{"id":"338d39016dcc_123","name":"3cb6","type":"P","href":null,"layout":null,"metadata":null,"text":"The paper also says that you should fit a parabola to the three histogram values closest to the maximum, which is done in the following function:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_124":{"id":"338d39016dcc_124","name":"a30d","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def fit_parabola(hist, binno, bin_width): \n  centerval = binno*bin_width + bin_width\u002F2. ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_125":{"id":"338d39016dcc_125","name":"2e8e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  if binno == len(hist)-1: rightval = 360 + bin_width\u002F2. \n  else: rightval = (binno+1)*bin_width + bin_width\u002F2. ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_126":{"id":"338d39016dcc_126","name":"5304","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  if binno == 0: leftval = -bin_width\u002F2. \n  else: leftval = (binno-1)*bin_width + bin_width\u002F2. ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_127":{"id":"338d39016dcc_127","name":"4685","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  A = np.array([ \n    [centerval**2, centerval, 1], \n    [rightval**2, rightval, 1], \n    [leftval**2, leftval, 1]]) \n  b = np.array([ \n    hist[binno], \n    hist[(binno+1)%len(hist)], \n    hist[(binno-1)%len(hist)]]) ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_128":{"id":"338d39016dcc_128","name":"46a5","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  x = LA.lstsq(A, b, rcond=None)[0] \n  if x[0] == 0: x[0] = 1e-6 \n  return -x[1]\u002F(2*x[0])","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_129":{"id":"338d39016dcc_129","name":"b3eb","type":"P","href":null,"layout":null,"metadata":null,"text":"We simply get the least squares solution where the center of the max histogram bin as well as its two adjacent bins are taken as the independent variable and the value at that histogram the dependent variable. Once the coefficients for the parabola have been found, just use -b\u002F2a to get the refined orientation.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_130":{"id":"338d39016dcc_130","name":"9cdb","type":"P","href":null,"layout":null,"metadata":null,"text":"There are also a few functions not included in this code. First is get_grads , which gets the gradient in polar coordinates at a pixel in L:","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:338d39016dcc_130.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_130.markups.0":{"type":"CODE","start":67,"end":76,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:338d39016dcc_131":{"id":"338d39016dcc_131","name":"fd3f","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def cart_to_polar_grad(dx, dy): \n  m = np.sqrt(dx**2 + dy**2) \n  theta = (np.arctan2(dy, dx)+np.pi) * 180\u002Fnp.pi \n  return m, theta ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_132":{"id":"338d39016dcc_132","name":"c828","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def get_grad(L, x, y): \n  dy = L[min(L.shape[0]-1, y+1),x] — L[max(0, y-1),x] \n  dx = L[y,min(L.shape[1]-1, x+1)] — L[y,max(0, x-1)] \n  return cart_to_polar_grad(dx, dy)","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_133":{"id":"338d39016dcc_133","name":"3774","type":"P","href":null,"layout":null,"metadata":null,"text":"Then there is quantize_orientation, which simply converts the continuous angle of the gradient to a histogram bin:","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:338d39016dcc_133.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_133.markups.0":{"type":"CODE","start":14,"end":34,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:338d39016dcc_134":{"id":"338d39016dcc_134","name":"94c3","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def quantize_orientation(theta, num_bins): \n  bin_width = 360\u002F\u002Fnum_bins \n  return int(np.floor(theta)\u002F\u002Fbin_width)","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_135":{"id":"338d39016dcc_135","name":"3c0b","type":"H3","href":null,"layout":null,"metadata":null,"text":"Local Descriptor Creation","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_136":{"id":"338d39016dcc_136","name":"b3db","type":"P","href":null,"layout":null,"metadata":null,"text":"Finally, we can create the local descriptors for each keypoint. As previously mentioned, we use the Histogram of Gradients method to create a feature vector from the surroundings of each keypoint.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:338d39016dcc_136.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_136.markups.0":{"type":"EM","start":0,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:338d39016dcc_137":{"id":"338d39016dcc_137","name":"b5d4","type":"P","href":null,"layout":null,"metadata":null,"text":"Specifically, a 16x16 patch is inspected around each keypoint. That patch is then split up into 16 4x4 subregions. The gradients (in polar coordinates) of each subregion are then binned into an 8-bin histogram. Finally, all of these histograms are concatenated into a 4x4x8=128 element long feature vector.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_138":{"id":"338d39016dcc_138","name":"1e26","type":"P","href":null,"layout":null,"metadata":null,"text":"This final feature vector is then normalized, thresholded, and renormalized to try and ensure invariance to minor lighting changes.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_139":{"id":"338d39016dcc_139","name":"4f8b","type":"H4","href":null,"layout":null,"metadata":null,"text":"Implementation","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_140":{"id":"338d39016dcc_140","name":"9e18","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def get_local_descriptors(kps, octave, w=16, num_subregion=4, num_bin=8): \n  descs = [] \n  bin_width = 360\u002F\u002Fnum_bin","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_141":{"id":"338d39016dcc_141","name":"c610","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  for kp in kps: \n    cx, cy, s = int(kp[0]), int(kp[1]), int(kp[2]) \n    s = np.clip(s, 0, octave.shape[2]-1) \n    kernel = gaussian_filter(w\u002F6) # gaussian_filter multiplies sigma by 3 \n    L = octave[…,s] ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_142":{"id":"338d39016dcc_142","name":"6262","type":"PRE","href":null,"layout":null,"metadata":null,"text":"    t, l = max(0, cy-w\u002F\u002F2), max(0, cx-w\u002F\u002F2) \n    b, r = min(L.shape[0], cy+w\u002F\u002F2+1), min(L.shape[1], cx+w\u002F\u002F2+1) \n    patch = L[t:b, l:r] \n    dx, dy = get_patch_grads(patch) ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_143":{"id":"338d39016dcc_143","name":"92f6","type":"PRE","href":null,"layout":null,"metadata":null,"text":"    if dx.shape[0] \u003C w+1: \n      if t == 0: kernel = kernel[kernel.shape[0]-dx.shape[0]:] \n      else: kernel = kernel[:dx.shape[0]] \n    if dx.shape[1] \u003C w+1: \n      if l == 0: kernel = kernel[kernel.shape[1]-dx.shape[1]:] \n      else: kernel = kernel[:dx.shape[1]] \n    if dy.shape[0] \u003C w+1: \n      if t == 0: kernel = kernel[kernel.shape[0]-dy.shape[0]:] \n      else: kernel = kernel[:dy.shape[0]] \n    if dy.shape[1] \u003C w+1: \n      if l == 0: kernel = kernel[kernel.shape[1]-dy.shape[1]:] \n      else: kernel = kernel[:dy.shape[1]] ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_144":{"id":"338d39016dcc_144","name":"3b25","type":"PRE","href":null,"layout":null,"metadata":null,"text":"    m, theta = cart_to_polar_grad(dx, dy) \n    dx, dy = dx*kernel, dy*kernel ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_145":{"id":"338d39016dcc_145","name":"7d11","type":"PRE","href":null,"layout":null,"metadata":null,"text":"    subregion_w = w\u002F\u002Fnum_subregion \n    featvec = np.zeros(num_bin * num_subregion**2, dtype=np.float32) ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_146":{"id":"338d39016dcc_146","name":"ba2d","type":"PRE","href":null,"layout":null,"metadata":null,"text":"    for i in range(0, subregion_w): \n      for j in range(0, subregion_w): \n        t, l = i*subregion_w, j*subregion_w \n        b, r = min(L.shape[0], (i+1)*subregion_w), min(L.shape[1], (j+1)*subregion_w) ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_147":{"id":"338d39016dcc_147","name":"4e4a","type":"PRE","href":null,"layout":null,"metadata":null,"text":"        hist = get_histogram_for_subregion(m[t:b, l:r].ravel(), theta[t:b, l:r].ravel(), num_bin, kp[3], bin_width, subregion_w) ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_148":{"id":"338d39016dcc_148","name":"a3c6","type":"PRE","href":null,"layout":null,"metadata":null,"text":"        featvec[i*subregion_w*num_bin + j*num_bin:i*subregion_w*num_bin + (j+1)*num_bin] = hist.flatten() ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_149":{"id":"338d39016dcc_149","name":"a8bf","type":"PRE","href":null,"layout":null,"metadata":null,"text":"    featvec \u002F= max(1e-6, LA.norm(featvec))        \n    featvec[featvec\u003E0.2] = 0.2        \n    featvec \u002F= max(1e-6, LA.norm(featvec))    \n    descs.append(featvec)","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_150":{"id":"338d39016dcc_150","name":"66a0","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  return np.array(descs)","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_151":{"id":"338d39016dcc_151","name":"0ce1","type":"P","href":null,"layout":null,"metadata":null,"text":"The checks on the shape of dx and dy in the middle are to avoid out of bounds errors I was getting earlier. If either\u002For are smaller than w+1 then cut off the Gaussian window accordingly to avoid shape mismatches.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:338d39016dcc_151.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:338d39016dcc_151.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:338d39016dcc_151.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_151.markups.0":{"type":"CODE","start":27,"end":29,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:338d39016dcc_151.markups.1":{"type":"CODE","start":34,"end":36,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:338d39016dcc_151.markups.2":{"type":"CODE","start":138,"end":141,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:338d39016dcc_152":{"id":"338d39016dcc_152","name":"ca47","type":"P","href":null,"layout":null,"metadata":null,"text":"First, the polar gradients are computed for the whole patch. Then the histogram is created for each subregion. Once the histogram for each subregion has been concatenated, the entire feature vector is normalized, thresholded to be less than or equal to 0.2, and then renormalized.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_153":{"id":"338d39016dcc_153","name":"5abf","type":"P","href":null,"layout":null,"metadata":null,"text":"I’m not 100% certain on the motivation behind the thresholding and renormalization but I believe it helps provide invariance to nonlinear lighting changes.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_154":{"id":"338d39016dcc_154","name":"114b","type":"P","href":null,"layout":null,"metadata":null,"text":"To calculate the gradients across the patch:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_155":{"id":"338d39016dcc_155","name":"505d","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def get_patch_grads(p): \n  r1 = np.zeros_like(p) \n  r1[-1] = p[-1] \n  r1[:-1] = p[1:] ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_156":{"id":"338d39016dcc_156","name":"cfdf","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  r2 = np.zeros_like(p) \n  r2[0] = p[0] \n  r2[1:] = p[:-1] ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_157":{"id":"338d39016dcc_157","name":"dbdc","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  dy = r1-r2 ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_158":{"id":"338d39016dcc_158","name":"61b5","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  r1[:,-1] = p[:,-1] \n  r1[:,:-1] = p[:,1:] \n  r2[:,0] = p[:,0] \n  r2[:,1:] = p[:,:-1] ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_159":{"id":"338d39016dcc_159","name":"4f71","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  dx = r1-r2 ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_160":{"id":"338d39016dcc_160","name":"03b9","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  return dx, dy","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_161":{"id":"338d39016dcc_161","name":"5414","type":"P","href":null,"layout":null,"metadata":null,"text":"Just take the difference between the previous and current pixels. This is easier than doing the double-sided derivative as before. Then to create the histogram for each subregion:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_162":{"id":"338d39016dcc_162","name":"2ed7","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def get_histogram_for_subregion(m, theta, num_bin, reference_angle, bin_width, subregion_w): \n  hist = np.zeros(num_bin, dtype=np.float32) \n  c = subregion_w\u002F2 - .5","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_163":{"id":"338d39016dcc_163","name":"ca63","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  for mag, angle in zip(m, theta):\n    angle = (angle-reference_angle) % 360        \n    binno = quantize_orientation(angle, num_bin)        \n    vote = mag      \n   \n    hist_interp_weight = 1 - abs(angle - (binno*bin_width + bin_width\u002F2))\u002F(bin_width\u002F2)        \n    vote *= max(hist_interp_weight, 1e-6)         ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_164":{"id":"338d39016dcc_164","name":"9344","type":"PRE","href":null,"layout":null,"metadata":null,"text":"    gy, gx = np.unravel_index(i, (subregion_w, subregion_w))        \n    x_interp_weight = max(1 - abs(gx - c)\u002Fc, 1e-6)            \n    y_interp_weight = max(1 - abs(gy - c)\u002Fc, 1e-6)        \n    vote *= x_interp_weight * y_interp_weight         ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_165":{"id":"338d39016dcc_165","name":"bafe","type":"PRE","href":null,"layout":null,"metadata":null,"text":"    hist[binno] += vote","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_166":{"id":"338d39016dcc_166","name":"77fb","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  hist \u002F= max(1e-6, LA.norm(hist)) \n  hist[hist\u003E0.2] = 0.2 \n  hist \u002F= max(1e-6, LA.norm(hist))\n  return hist","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_167":{"id":"338d39016dcc_167","name":"4abb","type":"P","href":null,"layout":null,"metadata":null,"text":"The code is fairly similar to the previous HoG code however we perform trilinear interpolation on each entry into the histogram. This interpolation is to provide robustness for when a gradient at a pixel either goes from one bin to the other or is at the edge of a subregion and goes into a different subregion.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_168":{"id":"338d39016dcc_168","name":"0ac2","type":"P","href":null,"layout":null,"metadata":null,"text":"Therefore, the weight of an entry is proportional to 1-(distance from the center of the bin) and well as 1-(distance from the center of the subregion) for both the x and y directions. The spatial (x and y) interpolation is the only thing I am not sure about because I could not find a reliable source on it.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_169":{"id":"338d39016dcc_169","name":"766d","type":"H3","href":null,"layout":null,"metadata":null,"text":"Putting it All Together","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_170":{"id":"338d39016dcc_170","name":"b566","type":"P","href":null,"layout":null,"metadata":null,"text":"We can now create a SIFT object to encapsulate all of the above operations:","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:338d39016dcc_170.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_170.markups.0":{"type":"CODE","start":20,"end":24,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:338d39016dcc_171":{"id":"338d39016dcc_171","name":"ca92","type":"PRE","href":null,"layout":null,"metadata":null,"text":"class SIFT(object): \n  def __init__(self, im, s=3, num_octave=4, s0=1.3, sigma=1.6, r_th=10, t_c=0.03, w=16): \n    self.im = convolve(rgb2gray(im), gaussian_filter(s0)) \n    self.s = s \n    self.sigma = sigma \n    self.num_octave = num_octave\n    self.t_c = t_c \n    self.R_th = (r_th+1)**2 \u002F r_th \n    self.w = w ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_172":{"id":"338d39016dcc_172","name":"0522","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  def get_features(self): \n    gaussian_pyr = generate_gaussian_pyramid(self.im, self.num_octave, self.s, self.sigma) \n    DoG_pyr = generate_DoG_pyramid(gaussian_pyr) \n    kp_pyr = get_keypoints(DoG_pyr, self.R_th, self.t_c, self.w) \n    feats = [] ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_173":{"id":"338d39016dcc_173","name":"8faa","type":"PRE","href":null,"layout":null,"metadata":null,"text":"    for i, DoG_octave in enumerate(DoG_pyr): kp_pyr[i] = \n      assign_orientation(kp_pyr[i], DoG_octave) \n      feats.append(get_local_descriptors(kp_pyr[i], DoG_octave)) ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_174":{"id":"338d39016dcc_174","name":"067e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"    self.kp_pyr = kp_pyr \n    self.feats = feats ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_175":{"id":"338d39016dcc_175","name":"10ea","type":"PRE","href":null,"layout":null,"metadata":null,"text":"    return feats","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_176":{"id":"338d39016dcc_176","name":"c2f3","type":"P","href":null,"layout":null,"metadata":null,"text":"One final small detail is that I blur the initial image with a sigma of 1.3. I did not see this in the paper but I saw it in a few implementations.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_177":{"id":"338d39016dcc_177","name":"2f03","type":"H3","href":null,"layout":null,"metadata":null,"text":"Conclusion","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_178":{"id":"338d39016dcc_178","name":"eef1","type":"P","href":null,"layout":null,"metadata":null,"text":"I know this has been really long and probably not all that clear in places, but I hope you learned something about both the theory and how to implement SIFT.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_179":{"id":"338d39016dcc_179","name":"5170","type":"P","href":null,"layout":null,"metadata":null,"text":"I’m aware that this is not a perfect implementation and nor does it implement every detail from the paper, but it empirically seems to work pretty well, whatever that means.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_180":{"id":"338d39016dcc_180","name":"52ab","type":"P","href":null,"layout":null,"metadata":null,"text":"If you’re curious, here is a link to the complete repository (even though almost all the code is here): https:\u002F\u002Fgithub.com\u002FSamL98\u002FPySIFT","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:338d39016dcc_180.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:338d39016dcc_180.markups.0":{"type":"A","start":104,"end":136,"href":"https:\u002F\u002Fgithub.com\u002FSamL98\u002FPySIFT","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Tag:computer-vision":{"id":"computer-vision","displayTitle":"Computer Vision","__typename":"Tag"},"Tag:sift":{"id":"sift","displayTitle":"Sift","__typename":"Tag"},"Tag:python":{"id":"python","displayTitle":"Python","__typename":"Tag"},"$Post:36c619df7945.previewContent":{"subtitle":"There’s a lot of content about SIFT online. There are a lot of good tutorials, but each seemed to be lacking something, whether that be…","__typename":"PreviewContent"}}</script><script src="./Implementing SIFT in Python - Sam Lerner - Medium_files/manifest.1aded676.js.download"></script><script src="./Implementing SIFT in Python - Sam Lerner - Medium_files/vendors_main.26101d5d.chunk.js.download"></script><script src="./Implementing SIFT in Python - Sam Lerner - Medium_files/main.2360d1c8.chunk.js.download"></script><script src="./Implementing SIFT in Python - Sam Lerner - Medium_files/vendors_screen.collection.packageBuilder_screen.collection.styleEditor_screen.landingpages.pres45_sc_873108c0.40da1149.chunk.js.download"></script>
<script src="./Implementing SIFT in Python - Sam Lerner - Medium_files/screen.collection.packageBuilder_screen.collection.styleEditor_screen.landingpages.pres45_screen.lan_edf4702d.3fed3768.chunk.js.download"></script>
<script src="./Implementing SIFT in Python - Sam Lerner - Medium_files/screen.collection.packageBuilder_screen.collection.styleEditor_screen.landingpages.pres45_screen.lan_624b8ed1.0d61fa66.chunk.js.download"></script>
<script src="./Implementing SIFT in Python - Sam Lerner - Medium_files/screen.post_screen.post.amp_screen.profile_screen.sequence.library_screen.sequence.post_screen.stori_aba94ffa.c6de8802.chunk.js.download"></script>
<script src="./Implementing SIFT in Python - Sam Lerner - Medium_files/screen.post.8a8b1dd3.chunk.js.download"></script><script>window.main();</script><script src="./Implementing SIFT in Python - Sam Lerner - Medium_files/p.js.download" async="" id="parsely-cf"></script></body></html>